{%- liquid
  assign zoom_size = 5000
  assign min_aspect_ratio = 0.6

  assign current_variant = product.selected_or_first_available_variant
  assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media

  unless product.has_only_default_variant
    if section.settings.select_first_variant == false and product.variants.size > 1
      assign current_variant = product.selected_variant | default: false
      unless current_variant
        assign featured_media = product.featured_media
      endunless
    endif
  endunless

  assign product_form_id = 'product-form-' | append: section.id | append: '-' | append: product.id

  assign enable_media_grouping = false
  if section.settings.enable_media_grouping
    for variant in product.variants
      if variant.featured_media
        assign enable_media_grouping = true
        break
      endif
    endfor
  endif
-%}

{% if section.settings.show_breadcrumbs %}
  <div class="container desktop-only not-in-quickbuy" {%- render 'animation-attrs', attrs: 'data-cc-animate data-cc-animate-delay="0.2s"' -%}>
    <div class="page-header">
      {% render 'breadcrumbs', show_next_prev: true %}
    </div>
  </div>
{% endif %}

<product-form class="js-product product-info quickbuy-content spaced-row {% if section.settings.enable_modern_gallery %} modern{% endif %}">

  {% comment %}
  Product Split Layout - 50/50 Desktop, Slider Mobile
{% endcomment %}

{% if section.settings.enable_modern_gallery %}
  <!-- Modern Gallery Version -->
  <div class="product-container gallery product-container--modern">
    <!-- Desktop: 2 Column Gallery -->
    <div class="product-gallery-desktop">
      {% for media in product.media %}
        <div class="gallery-item" data-media-index="{{ forloop.index0 }}">
          {% case media.media_type %}
            {% when 'image' %}
              <img
                src="{{ media | image_url: width: 1000 }}"
                alt="{{ media.alt | escape }}"
                width="{{ media.width }}"
                height="{{ media.height }}"
                loading="{% if forloop.index <= 4 %}eager{% else %}lazy{% endif %}"
                {% if forloop.index <= 2 %}fetchpriority="high"{% endif %}
              >
            {% when 'video' %}
              {{ media | media_tag: autoplay: true, loop: true, muted: true }}
            {% when 'external_video' %}
              {{ media | media_tag }}
            {% when 'model' %}
              {{ media | media_tag }}
          {% endcase %}
        </div>
      {% endfor %}
    </div>

    <!-- Mobile: Slider with Thumbnails -->
    <div class="product-slider-container product-slider-container--modern">
      <div class="product-slider product-slider--modern" id="productSliderModern">
        {% for media in product.media %}
          <div class="slider-slide slider-slide--modern" data-slide-index="{{ forloop.index0 }}">
            {% case media.media_type %}
              {% when 'image' %}
                <img
                  src="{{ media | image_url: width: 1000 }}"
                  alt="{{ media.alt | escape }}"
                  width="{{ media.width }}"
                  height="{{ media.height }}"
                  loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                  {% if forloop.first %}fetchpriority="high"{% endif %}
                >
              {% when 'video' %}
                {{ media | media_tag: autoplay: true, loop: true, muted: true }}
              {% when 'external_video' %}
                {{ media | media_tag }}
              {% when 'model' %}
                {{ media | media_tag }}
            {% endcase %}
          </div>
        {% endfor %}
      </div>

      <!-- Navigation Arrows (Mobile) -->
      {% if product.media.size > 1 %}
        <button class="slider-nav prev slider-nav--modern" id="prevBtnModern" aria-label="Previous slide">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <button class="slider-nav next slider-nav--modern" id="nextBtnModern" aria-label="Next slide">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>

        <!-- Dots Navigation -->
        <div class="slider-dots slider-dots--modern" id="sliderDotsModern"></div>
      {% endif %}
    </div>

    <!-- Mobile: Thumbnails -->
    {% if product.media.size > 1 %}
      <div class="product-thumbnails" id="productThumbnails">
        {% for media in product.media %}
          <button 
            class="thumbnail-item {% if forloop.first %}active{% endif %}" 
            data-thumbnail-index="{{ forloop.index0 }}"
            aria-label="Go to slide {{ forloop.index }}"
          >
            {% if media.media_type == 'image' %}
              <img
                src="{{ media | image_url: width: 150 }}"
                alt="{{ media.alt | escape }}"
                width="80"
                height="80"
                loading="lazy"
              >
            {% else %}
              <div class="thumbnail-placeholder">
                {% if media.media_type == 'video' or media.media_type == 'external_video' %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                  </svg>
                {% else %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  </svg>
                {% endif %}
              </div>
            {% endif %}
          </button>
        {% endfor %}
      </div>
    {% endif %}

    {%- for block in section.blocks -%}
    {%- if block.type == 'testimonial_under_gallery' and block.settings.left_side -%}
      {% render 'testimonial-under-gallery', block: block, render_version: 'desktop' %}
    {%- endif -%}
  {%- endfor -%}
  </div>

 

  <script>
    (function() {
      const slider = document.getElementById('productSliderModern');
      const prevBtn = document.getElementById('prevBtnModern');
      const nextBtn = document.getElementById('nextBtnModern');
      const dotsContainer = document.getElementById('sliderDotsModern');
      const thumbnailsContainer = document.getElementById('productThumbnails');

      if (!slider) return;

      const allSlides = slider.querySelectorAll('.slider-slide--modern');
      const totalSlides = allSlides.length;
      let currentIndex = 0;

      // Create dots
      if (dotsContainer && totalSlides > 1) {
        for (let i = 0; i < totalSlides; i++) {
          const dot = document.createElement('button');
          dot.className = 'slider-dot';
          if (i === 0) dot.classList.add('active');
          dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
          dot.addEventListener('click', () => {
            goToSlide(i);
          });
          dotsContainer.appendChild(dot);
        }
      }

      const dots = dotsContainer ? dotsContainer.querySelectorAll('.slider-dot') : [];
      const thumbnails = thumbnailsContainer ? thumbnailsContainer.querySelectorAll('.thumbnail-item') : [];

      function updateSlider() {
        // Calculate slide width including gap
        const isMobile = window.innerWidth <= 767;
        let slideWidth = 0;
        
        if (isMobile && allSlides.length > 0) {
          // On mobile, use 80vw + gap
          const gap = 8; // 8px gap
          slideWidth = window.innerWidth * 0.8 + gap;
        } else {
          // On desktop/tablet, use 100% of slide width
          if (allSlides.length > 0) {
            slideWidth = allSlides[0].offsetWidth;
          }
        }
        
        // Update slider position - move to align current slide to the left
        slider.style.transform = `translateX(-${currentIndex * slideWidth}px)`;

        // Update dots
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentIndex);
        });

        // Update thumbnails
        thumbnails.forEach((thumb, index) => {
          thumb.classList.toggle('active', index === currentIndex);
        });

        // Scroll thumbnail into view
        if (thumbnailsContainer && thumbnails[currentIndex]) {
          const activeThumb = thumbnails[currentIndex];
          const containerRect = thumbnailsContainer.getBoundingClientRect();
          const thumbRect = activeThumb.getBoundingClientRect();
          
          if (thumbRect.left < containerRect.left) {
            thumbnailsContainer.scrollTo({
              left: activeThumb.offsetLeft - thumbnailsContainer.offsetLeft - 20,
              behavior: 'smooth'
            });
          } else if (thumbRect.right > containerRect.right) {
            thumbnailsContainer.scrollTo({
              left: activeThumb.offsetLeft - thumbnailsContainer.offsetLeft + activeThumb.offsetWidth - containerRect.width + 20,
              behavior: 'smooth'
            });
          }
        }
      }

      function goToSlide(index) {
        if (index < 0 || index >= totalSlides) return;
        currentIndex = index;
        updateSlider();
      }

      function nextSlide() {
        currentIndex = (currentIndex + 1) % totalSlides;
        updateSlider();
      }

      function prevSlide() {
        currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
        updateSlider();
      }

      // Navigation buttons
      if (prevBtn) {
        prevBtn.addEventListener('click', prevSlide);
      }

      if (nextBtn) {
        nextBtn.addEventListener('click', nextSlide);
      }

      // Thumbnail clicks
      thumbnails.forEach((thumb, index) => {
        thumb.addEventListener('click', () => {
          goToSlide(index);
        });
      });

      // Touch/swipe support
      let touchStartX = 0;
      let touchEndX = 0;

      slider.addEventListener('touchstart', e => {
        touchStartX = e.changedTouches[0].screenX;
      });

      slider.addEventListener('touchend', e => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });

      function handleSwipe() {
        if (touchEndX < touchStartX - 50) {
          nextSlide();
        }
        if (touchEndX > touchStartX + 50) {
          prevSlide();
        }
      }

      // Handle window resize
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          updateSlider();
        }, 100);
      });

      // Initialize
      updateSlider();
    })();
  </script>
{% else %}
  <!-- Original Gallery Version -->
  <div class="product-container">
    <!-- Left Side: Main Product Image (Desktop Only) -->
    {% if product.featured_media %}
      <div class="product-main-image">
        <img
          src="{{ product.featured_media | image_url: width: 1000 }}"
          alt="{{ product.featured_media.alt | escape }}"
          width="{{ product.featured_media.width }}"
          height="{{ product.featured_media.height }}"
          loading="eager"
          fetchpriority="high"
        >
      </div>
    {% endif %}

    <!-- Right Side: Media Slider -->
    <div class="product-slider-container">
      <div class="product-slider" id="productSlider">
        {% for media in product.media %}
          <div class="slider-slide {% if forloop.first %}desktop-hide-slide{% endif %}" data-slide-index="{{ forloop.index0 }}">
            {% case media.media_type %}
              {% when 'image' %}
                <img
                  src="{{ media | image_url: width: 1000 }}"
                  alt="{{ media.alt | escape }}"
                  width="{{ media.width }}"
                  height="{{ media.height }}"
                  loading="lazy"
                >
              {% when 'video' %}
                {{ media | media_tag: autoplay: true, loop: true, muted: true }}
              {% when 'external_video' %}
                {{ media | media_tag }}
              {% when 'model' %}
                {{ media | media_tag }}
            {% endcase %}
          </div>
        {% endfor %}
      </div>

      <!-- Navigation Arrows -->
      {% if product.media.size > 1 %}
        <button class="slider-nav prev" id="prevBtn" aria-label="Previous slide">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <button class="slider-nav next" id="nextBtn" aria-label="Next slide">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>

        <!-- Dots Navigation -->
        <div class="slider-dots" id="sliderDots"></div>
      {% endif %}
    </div>
  </div>

  <script>
    (function() {
      const slider = document.getElementById('productSlider');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const dotsContainer = document.getElementById('sliderDots');

      if (!slider) return;

      const allSlides = slider.querySelectorAll('.slider-slide');
      const isMobile = window.innerWidth <= 1499;

      // Get visible slides based on screen size
      let visibleSlides = [];
      let slideIndexMap = []; // Maps visible index to actual DOM index

      allSlides.forEach((slide, index) => {
        const isDesktopHidden = slide.classList.contains('desktop-hide-slide');
        if (isMobile || !isDesktopHidden) {
          visibleSlides.push(slide);
          slideIndexMap.push(index);
        }
      });

      let currentVisibleIndex = 0;
      const totalVisibleSlides = visibleSlides.length;

      // Create dots for visible slides only
      slideIndexMap.forEach((actualIndex, visibleIndex) => {
        const dot = document.createElement('button');
        dot.className = 'slider-dot';
        if (visibleIndex === 0) dot.classList.add('active');
        dot.setAttribute('aria-label', `Go to slide ${visibleIndex + 1}`);
        dot.addEventListener('click', () => {
          currentVisibleIndex = visibleIndex;
          updateSlider();
        });
        dotsContainer.appendChild(dot);
      });

      const dots = dotsContainer.querySelectorAll('.slider-dot');

      function updateSlider() {
        const actualSlideIndex = slideIndexMap[currentVisibleIndex];
        slider.style.transform = `translateX(-${actualSlideIndex * 100}%)`;

        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentVisibleIndex);
        });
      }

      function nextSlide() {
        currentVisibleIndex = (currentVisibleIndex + 1) % totalVisibleSlides;
        updateSlider();
      }

      function prevSlide() {
        currentVisibleIndex = (currentVisibleIndex - 1 + totalVisibleSlides) % totalVisibleSlides;
        updateSlider();
      }

      if (prevBtn) {
        prevBtn.addEventListener('click', prevSlide);
      }

      if (nextBtn) {
        nextBtn.addEventListener('click', nextSlide);
      }

      // Touch/swipe support
      let touchStartX = 0;
      let touchEndX = 0;

      slider.addEventListener('touchstart', e => {
        touchStartX = e.changedTouches[0].screenX;
      });

      slider.addEventListener('touchend', e => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });

      function handleSwipe() {
        if (touchEndX < touchStartX - 50) {
          nextSlide();
        }
        if (touchEndX > touchStartX + 50) {
          prevSlide();
        }
      }

      // Initialize
      updateSlider();
    })();
  </script>
{% endif %}

<script>
  (function() {
    const slider = document.getElementById('productSlider');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const dotsContainer = document.getElementById('sliderDots');

    if (!slider) return;

    const allSlides = slider.querySelectorAll('.slider-slide');
    const isMobile = window.innerWidth <= 1499;

    // Get visible slides based on screen size
    let visibleSlides = [];
    let slideIndexMap = []; // Maps visible index to actual DOM index

    allSlides.forEach((slide, index) => {
      const isDesktopHidden = slide.classList.contains('desktop-hide-slide');
      if (isMobile || !isDesktopHidden) {
        visibleSlides.push(slide);
        slideIndexMap.push(index);
      }
    });

    let currentVisibleIndex = 0;
    const totalVisibleSlides = visibleSlides.length;

    // Create dots for visible slides only
    slideIndexMap.forEach((actualIndex, visibleIndex) => {
      const dot = document.createElement('button');
      dot.className = 'slider-dot';
      if (visibleIndex === 0) dot.classList.add('active');
      dot.setAttribute('aria-label', `Go to slide ${visibleIndex + 1}`);
      dot.addEventListener('click', () => {
        currentVisibleIndex = visibleIndex;
        updateSlider();
      });
      dotsContainer.appendChild(dot);
    });

    const dots = dotsContainer.querySelectorAll('.slider-dot');

    function updateSlider() {
      const actualSlideIndex = slideIndexMap[currentVisibleIndex];
      slider.style.transform = `translateX(-${actualSlideIndex * 100}%)`;

      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentVisibleIndex);
      });
    }

    function nextSlide() {
      currentVisibleIndex = (currentVisibleIndex + 1) % totalVisibleSlides;
      updateSlider();
    }

    function prevSlide() {
      currentVisibleIndex = (currentVisibleIndex - 1 + totalVisibleSlides) % totalVisibleSlides;
      updateSlider();
    }

    if (prevBtn) {
      prevBtn.addEventListener('click', prevSlide);
    }

    if (nextBtn) {
      nextBtn.addEventListener('click', nextSlide);
    }

    // Touch/swipe support
    let touchStartX = 0;
    let touchEndX = 0;

    slider.addEventListener('touchstart', e => {
      touchStartX = e.changedTouches[0].screenX;
    });

    slider.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });

    function handleSwipe() {
      if (touchEndX < touchStartX - 50) {
        nextSlide();
      }
      if (touchEndX > touchStartX + 50) {
        prevSlide();
      }
    }

    // Initialize
    updateSlider();
  })();
</script>

  <div class="detail product-column-right" {%- render 'animation-attrs', attrs: 'data-cc-animate data-cc-animate-delay="0.2s"' -%}>
    <div class="product-form{% if section.settings.enable_sticky_columns %} sticky-content-container{% endif %}" id="ProductInfo-{{ section.id }}" data-ajax-add-to-cart="true" data-product-id="{{ product.id }}">
      {%- if section.settings.enable_sticky_atc -%}
        <a class="sticky-atc-anchor" id="product-info" rel="nofollow"></a>
      {%- endif -%}
      {% for block in section.blocks %}
        {% case block.type %}
          {% when '@app' %}
            <div class="{% unless settings.qb_show_app_blocks %}not-in-quickbuy{% endunless %}">
              {% render block %}
            </div>

          {% when 'title' %}
            <div class="title-row" {{ block.shopify_attributes }}>
              <h1 class="product-title">{{ product.title | escape }}</h1>
            </div>

          {% when 'price' %}
            <div class="price-container" {{ block.shopify_attributes }}>
              <div class="product-info__price product-price product-price--large" role="status">
                {% render 'price', product: product, show_currency_code: settings.product_currency_code_enabled, for_variant_picker: true, current_variant: current_variant %}
              </div>

              <div class="price-descriptors">
                {%- form 'product', product, class: 'js-instalments-form' -%}
                  <input type="hidden" name="id" value="{% if current_variant %}{{ current_variant.id }}{% endif %}">
                  {{ form | payment_terms }}
                {%- endform -%}

                {%- if block.settings.show_tax_and_shipping -%}
                  {%- if cart.taxes_included or shop.shipping_policy.body != blank -%}
                    <div class="product-policies">
                      {%- if cart.taxes_included -%}
                        {{ 'products.product.include_taxes' | t }}
                      {%- endif -%}
                      {%- if shop.shipping_policy.body != blank -%}
                        {{ 'products.product.shipping_policy_html' | t: link: shop.shipping_policy.url }}
                      {%- endif -%}
                    </div>
                  {%- endif -%}
                {%- endif -%}

                {% if section.settings.inventory_transfers_enable %}
                  <variant-content class="product-inventory-transfer">
                    {%- for variant in product.variants -%}
                      {%- if variant.incoming -%}
                        {%- liquid
                          if variant.next_incoming_date
                            assign date = variant.next_incoming_date | date: format: 'date'
                            if variant.available
                              assign incoming_html = 'products.transfers.will_not_ship_until' | t: date: date
                            else
                              assign incoming_html = 'products.transfers.will_be_in_stock_after' | t: date: date
                            endif
                          else
                            assign incoming_html = 'products.transfers.waiting_for_stock' | t
                          endif
                        -%}
                        <script type="text/template" data-variant="{{ variant.id }}">{{ incoming_html }}</script>

                        {%- if current_variant and variant.id == current_variant.id -%}{{ incoming_html }}{%- endif -%}
                      {%- endif -%}
                    {%- endfor -%}
                  </variant-content>
                {% endif %}
              </div>

              {%- if block.settings.enable_product_reviews_by_price and product.metafields.reviews.rating_count != blank -%}
                {%- assign rating_count = product.metafields.reviews.rating_count | plus: 0 -%}
                {%- if rating_count > 0 -%}
                  <div class="theme-product-reviews">
                    {% render 'rating', rating_value: product.metafields.reviews.rating.value %}
                    <span class="cc-rating-custom-caption">
                      {{- 'products.product.reviews_count' | t: count: rating_count -}}
                    </span>
                  </div>
                {%- endif -%}
              {%- endif -%}
            </div>
            {%- when 'video_slide' -%}
              {%- liquid
                assign is_first_in_group = false
                assign previous_block_index = forloop.index0 | minus: 1
                assign previous_block = blank
                
                if previous_block_index >= 0 and previous_block_index < section.blocks.size
                  assign previous_block = section.blocks[previous_block_index]
                endif
                
                if forloop.index0 == 0 or previous_block.type != 'video_slide'
                  assign is_first_in_group = true
                  assign video_slide_count = 0
                  assign video_slide_start_index = forloop.index0
                  for i in (forloop.index0..section.blocks.size)
                    if i < section.blocks.size
                      assign check_block = section.blocks[i]
                      if check_block.type == 'video_slide'
                        assign video_slide_count = video_slide_count | plus: 1
                      else
                        break
                      endif
                    else
                      break
                    endif
                  endfor
                endif
                
                assign next_block_index = forloop.index0 | plus: 1
                assign next_block = blank
                if next_block_index < section.blocks.size
                  assign next_block = section.blocks[next_block_index]
                endif
              -%}
              {% render 'video-slide', 
                block: block, 
                section: section, 
                block_index: forloop.index0, 
                is_last: forloop.last, 
                next_block: next_block,
                is_first_in_group: is_first_in_group,
                video_slide_count: video_slide_count,
                video_slide_start_index: video_slide_start_index
              %}
          {% when 'description' %}
            {%- if product.description != blank -%}
              <div class="{% unless block.settings.show_in_quickbuy %}not-in-quickbuy{% endunless %}{% if block.settings.show_in_tab %} product-info-accordion{% endif %}" {{ block.shopify_attributes }}>
                {% if block.settings.show_in_tab %}
                  <details-disclosure>
                    <details class="disclosure"{% if block.settings.open_tab %} open{% endif %}>
                      <summary class="disclosure__title">
                        {%- if block.settings.icon == blank -%}
                          {{- 'products.product.description' | t -}}
                        {%- else -%}
                          <div class="with-icon">
                            {% render 'icon', icon: block.settings.icon, size: 'small' %}
                            <span class="with-icon__beside">{{ 'products.product.description' | t }}</span>
                          </div>
                        {%- endif -%}
                      </summary>
                      <div class="disclosure__panel has-motion">
                        <div class="disclosure__content rte cf">
                          {{- product.description -}}
                        </div>
                      </div>
                    </details>
                  </details-disclosure>
                {% else %}
                  <div class="product-description rte cf">
                    {%- if block.settings.icon == blank -%}
                      {{- product.description -}}
                    {%- else -%}
                      <div class="with-icon">
                        {% render 'icon', icon: block.settings.icon, size: 'small' %}
                        <span class="with-icon__beside">{{ product.description }}</span>
                      </div>
                    {%- endif -%}
                  </div>
                {% endif %}
              </div>
            {%- endif -%}

          {% when 'vendor' %}
            {%- liquid
              assign product_vendor_handle = product.vendor | handle
              if collections[product_vendor_handle].handle == product_vendor_handle
                assign vendor_url = collections[product_vendor_handle].url
              else
                assign vendor_url = product.vendor | url_for_vendor
              endif
            -%}
            <div class="vendor lightly-spaced-row" {{ block.shopify_attributes }}>
              <span class="product-info-label">{{ 'products.product.vendor' | t }}</span> {{ product.vendor | link_to: vendor_url, class: 'underline' }}
            </div>

          {% when 'sku' %}
            <div class="product-sku"{% if current_variant == blank or current_variant.sku == blank %} hidden{% endif %} {{ block.shopify_attributes }}>
              <span class="product-info-label">{{ 'products.product.sku' | t }}</span> <span class="product-sku__value">{% if current_variant %}{{ current_variant.sku }}{% endif %}</span>
            </div>

          {% when 'barcode' %}
            <div class="product-barcode"{% if current_variant == blank or current_variant.barcode == blank %} hidden{% endif %} {{ block.shopify_attributes }}>
              <span class="product-info-label">{{ 'products.product.barcode' | t }}</span> <span class="product-barcode__value">{% if current_variant %}{{ current_variant.barcode }}{% endif %}</span>
            </div>

          {% when 'variant-picker' %}
            <div class="input-row" {{ block.shopify_attributes }}>
              {%- capture size_chart_icon -%}{%- render 'icon', icon: 'ruler', size: 'small' -%}{%- endcapture -%}
              {% render 'variant-picker',
                product: product,
                product_form_id: product_form_id,
                block: block,
                update_url: true,
                size_chart_icon: size_chart_icon,
                media_ratio: 1,
                swatch_crop: settings.swatch_crop_align
              %}
            </div>

          {% when 'formula_button' %}

            <!-- Quiz Incomplete CTA (Hidden by default, shown by JS if quiz not completed) -->
            <div class="quiz-cta-wrapper {{ block.id }}-get-your-formula-wrapper" style="display: none;">
              <a href="{{ block.settings.quiz_cta_url | default: '/pages/get-your-formula' }}" class="btn btn--wide quiz-cta-button">
                {{ block.settings.quiz_cta_text | default: 'Get Your Formula' }}
              </a>
            </div>

            <style>
            @media (min-width: 768px) {
              .{{ block.id }}-get-your-formula-wrapper {
              display: none!important;
              }
            }
            </style>

            <script>
              // Check if quiz is completed
              (function() {
                const quizCompleted2 = localStorage.getItem('quiz_completed') === 'true';
                const buyButtonsBlock2 = document.querySelector('.{{ block.id }}-get-your-formula-wrapper');

                // Check if product has "no consult" tag
                const productTags = {{ product.tags | json }};
                const hasNoConsultTag = productTags.some(tag =>
                  tag.toLowerCase() === 'no consult' || tag.toLowerCase() === 'no-consult'
                );

                if (buyButtonsBlock2) {
                  // If product has "no consult" tag, always hide quiz CTA (allow direct purchase)
                  if (hasNoConsultTag) {
                    buyButtonsBlock2.style.display = 'none';
                  } else if (!quizCompleted2) {
                    // Hide regular buy buttons, show quiz CTA
                    buyButtonsBlock2.style.display = 'block';
                  } else {
                    // Show regular buy buttons, hide quiz CTA
                    buyButtonsBlock2.style.display = 'none';
                  }
                }
              })();
            </script>

          {% when 'buy-buttons' %}
            {% if block.settings.sub-block-label != blank%}
              <h2 class="subscription-title">{{ block.settings.sub-block-label }}</h2>
            {% endif %}
            <buy-buttons class="buy-buttons-row block {% if block.settings.sub-block-label != blank%} mt-12{% endif %}" {{ block.shopify_attributes }}>
              {% form 'product', product, id: product_form_id, class: 'form js-product-form', data-product-id: product.id %}
                <input type="hidden" name="id" value="{{ current_variant.id }}">

                {% if product.available %}
                  {%- liquid
                    assign gift_card_recipient_feature_active = false
                    if block.settings.show_gift_card_recipient and product.gift_card?
                      assign gift_card_recipient_feature_active = true
                    endif

                    assign enable_dynamic_payment_button = false
                    if block.settings.enable_payment_button and product.selling_plan_groups == empty and gift_card_recipient_feature_active == false
                      unless product.template_suffix contains 'preorder'
                        assign enable_dynamic_payment_button = true
                      endunless
                    endif
                  -%}

                  {% if gift_card_recipient_feature_active %}
                    {% render 'gift-card-recipient', section: section %}
                  {% endif %}

                  {%- comment -%} Custom Subscription Picker {%- endcomment -%}
                  {%- if product.selling_plan_groups.size > 0 and block.settings.enable_subscription_picker -%}
                    <div class="custom-subscription-picker" 
                         data-block-id="{{ block.id }}" 
                         data-form-id="{{ product_form_id }}" 
                         data-use-custom-benefits="{{ block.settings.use_custom_benefits }}"
                         style="display: none;">
                    {%- liquid
                      assign first_group = product.selling_plan_groups.first
                      assign default_selling_plan = first_group.selling_plans.first
                      assign subscription_title = block.settings.subscription_title | default: 'SUBSCRIBE AND SAVE 15%'
                      assign one_time_label = block.settings.one_time_label | default: 'One-time purchase'
                      assign subscribe_label = block.settings.subscribe_label | default: 'Subscribe & Save'
                      assign most_popular_text = block.settings.most_popular_text | default: 'MOST POPULAR'
                      assign show_most_popular = block.settings.show_most_popular
                      assign default_selection = block.settings.default_selection | default: 'subscription'
                    -%}
                      
                      <div class="subscription-picker__options">
                        <!-- One-time Purchase Option -->
                        <div class="subscription-option {% if default_selection == 'one-time' %}subscription-option--active{% endif %}" data-option-type="one-time">
                          
                          <div class="subscription-option__content">
                            <div class="subscription-option__content-header">
                              <div class="content-header__leftside">
                                <div class="subscription-option__radio">
                                    <input type="radio" 
                                          name="subscription_type_{{ block.id }}" 
                                          id="one-time-{{ block.id }}" 
                                          value="one-time" 
                                          {% if default_selection == 'one-time' %}checked{% endif %}
                                          class="subscription-radio">
                                    <span class="subscription-radio-custom"></span>
                                </div>
                                <label class="subscription-option__label" for="one-time-{{ block.id }}" data-one-time-label>
                                  {{ one_time_label }}
                                </label>
                              </div>
                              <div class="subscription-option__price">
                                <div class="subscription-price">
                                  <span class="subscription-price__current" data-one-time-price>
                                    {% render 'price', product: product, show_currency_code: false, for_variant_picker: true, current_variant: current_variant %}
                                  </span>
                                  {% if current_variant.compare_at_price > current_variant.price %}
                                    <span class="subscription-price__original" data-one-time-compare>
                                      {% render 'price', product: product, show_currency_code: false, for_variant_picker: true, current_variant: current_variant, price_type: 'compare' %}
                                    </span>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Subscribe & Save Option -->
                        <div class="subscription-option subscription-option--subscribe {% if default_selection == 'subscription' %}subscription-option--active{% endif %}" data-option-type="subscription">
                          {% if show_most_popular and most_popular_text != blank %}
                            <div class="subscription-option__badge">{{ most_popular_text }}</div>
                          {% endif %}
                        
                          <div class="subscription-option__content">
                            <div class="subscription-option__content-header">
                              <div class="content-header__leftside">
                                  <div class="subscription-option__radio">
                                    <input type="radio" 
                                          name="subscription_type_{{ block.id }}" 
                                          id="subscription-{{ block.id }}" 
                                          value="subscription" 
                                          {% if default_selection == 'subscription' %}checked{% endif %}
                                          class="subscription-radio">
                                      <span class="subscription-radio-custom"></span>
                                  </div>
                                <label class="subscription-option__label" for="subscription-{{ block.id }}" data-subscribe-label>
                                  {{ subscribe_label }}
                                  {% if block.settings.savings_badge_text != blank %}
                                    <span class="subscription-savings-badge" data-savings-badge>{{ block.settings.savings_badge_text }}</span>
                                  {% endif %}
                                </label>
                              </div>
                              <div class="subscription-option__price">
                                <div class="subscription-price">
                                  <span class="subscription-price__current" data-subscription-price>
                                    {%- if default_selling_plan -%}
                                      {%- for allocation in current_variant.selling_plan_allocations -%}
                                        {%- if allocation.selling_plan.id == default_selling_plan.id -%}
                                          <span class="money">{{ allocation.price | money }}</span>
                                        {%- endif -%}
                                      {%- endfor -%}
                                    {%- endif -%}
                                  </span>
                                  <span class="subscription-price__original" data-subscription-compare>
                                    {% render 'price', product: product, show_currency_code: false, for_variant_picker: true, current_variant: current_variant, price_type: 'compare' %}
                                  </span>
                                </div>
                              </div>
                            </div>
                            
                            <div class="subscription-option__expandable" data-subscription-expandable>
                              {% if first_group.selling_plans.size > 1 %}
                                <div class="subscription-option__interval">
                                  {% comment %} <label class="subscription-interval-label" data-interval-label>{{ block.settings.interval_label | default: 'Deliver & Pay every' }}</label> {% endcomment %}
                                  <select class="subscription-interval-select" name="subscription_interval_{{ block.id }}" data-interval-select>
                                    {% for plan in first_group.selling_plans %}
                                      <option value="{{ plan.id }}" 
                                              data-plan-id="{{ plan.id }}"
                                              {% if forloop.first %}selected{% endif %}>
                                        {{ plan.options[0].value }}
                                      </option>
                                    {% endfor %}
                                  </select>
                                </div>
                              {% endif %}
                              
                              <div class="subscription-option__benefits" data-subscription-benefits>
                                {% if block.settings.use_custom_benefits %}
                                  {% if block.settings.subscription_benefits != blank %}
                                    {{ block.settings.subscription_benefits }}
                                  {% endif %}
                                {% endif %}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      {% if block.settings.subscription_details != blank %}
                        <div class="subscription-picker__details">
                          <details class="subscription-details">
                            <summary class="subscription-details__summary">
                              <span class="subscription-details__icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                  <path d="M8 0C3.58 0 0 3.58 0 8C0 12.42 3.58 16 8 16C12.42 16 16 12.42 16 8C16 3.58 12.42 0 8 0Z" fill="currentColor"/>
                                  <path d="M8 4C8.55 4 9 4.45 9 5C9 5.55 8.55 6 8 6C7.45 6 7 5.55 7 5C7 4.45 7.45 4 8 4ZM9 11H7V7H9V11Z" fill="white"/>
                                </svg>
                              </span>
                              <span class="subscription-details__label">{{ block.settings.subscription_details_label | default: 'Subscription details' }}</span>
                            </summary>
                            <div class="subscription-details__content" data-subscription-details>
                              {% if block.settings.subscription_details != blank %}
                                {{ block.settings.subscription_details }}
                              {% endif %}
                            </div>
                          </details>
                        </div>
                      {% endif %}
                    </div>

                    <script>
                      (function() {
                        console.log('[Subscription Picker] Script started');
                        const blockId = '{{ block.id }}';
                        const formId = '{{ product_form_id }}';
                        console.log('[Subscription Picker] Block ID:', blockId, 'Form ID:', formId);
                        
                        const picker = document.querySelector('.custom-subscription-picker[data-block-id="' + blockId + '"]');
                        if (!picker) {
                          console.warn('[Subscription Picker] Picker not found, exiting');
                          return;
                        }
                        console.log('[Subscription Picker] Picker found:', picker);

                        let productData = null;
                        let sealSubsData = null;
                        let sellingPlanInput = null;
                        let form = null;
                        let intervalSelect = null;
                        let isInitialized = false;
                        let observerActive = false;

                        // Hide Seal Subscriptions block
                        function hideSealSubscriptions() {
                          console.log('[Subscription Picker] hideSealSubscriptions called');
                          const sealSubsElements = document.querySelectorAll('.sealsubs-target-element.sealsubs-full, .sealsubs-container');
                          console.log('[Subscription Picker] Found Seal Subscriptions elements:', sealSubsElements.length);
                          sealSubsElements.forEach(el => {
                            if (el) {
                              el.style.display = 'none';
                              el.setAttribute('aria-hidden', 'true');
                            }
                          });
                        }

                        // Parse data from Seal Subscriptions
                        function parseSealSubscriptionsData() {
                          console.log('[Subscription Picker] parseSealSubscriptionsData called');
                          const sealSubsElement = document.querySelector('.sealsubs-target-element.sealsubs-full[data-product]');
                          if (!sealSubsElement) {
                            console.log('[Subscription Picker] Seal Subscriptions element not found');
                            return null;
                          }
                          console.log('[Subscription Picker] Seal Subscriptions element found:', sealSubsElement);

                          try {
                            const productJson = sealSubsElement.getAttribute('data-product');
                            if (!productJson) {
                              console.log('[Subscription Picker] No data-product attribute');
                              return null;
                            }
                            console.log('[Subscription Picker] Product JSON length:', productJson.length);

                            const data = JSON.parse(productJson);
                            console.log('[Subscription Picker] Parsed data:', data);
                            return data;
                          } catch (e) {
                            console.error('[Subscription Picker] Error parsing Seal Subscriptions data:', e);
                            return null;
                          }
                        }

                        // Extract data from Seal Subscriptions and update our picker
                        function extractDataFromSealSubs() {
                          console.log('[Subscription Picker] extractDataFromSealSubs called');
                          sealSubsData = parseSealSubscriptionsData();
                          if (!sealSubsData) {
                            console.log('[Subscription Picker] No Seal Subscriptions data found');
                            return false;
                          }

                          // Extract selling plan groups
                          if (sealSubsData.selling_plan_groups && sealSubsData.selling_plan_groups.length > 0) {
                            const group = sealSubsData.selling_plan_groups[0];
                            console.log('[Subscription Picker] Found selling plan group:', group);
                            
                            // Extract selling plans
                            const sellingPlans = group.selling_plans || [];
                            console.log('[Subscription Picker] Selling plans count:', sellingPlans.length);
                            
                            // Extract variants with allocations
                            const variants = sealSubsData.variants || [];
                            console.log('[Subscription Picker] Variants count:', variants.length);

                            // Update productData
                            // Preserve existing compare_at_price if not provided in Seal Subscriptions data
                            const existingVariants = productData && productData.variants ? productData.variants : [];
                            
                            productData = {
                              variants: variants.map(v => {
                                const variantId = parseInt(v.id);
                                // Try to find existing variant to preserve compare_at_price if not in Seal Subscriptions data
                                const existingVariant = existingVariants.find(ev => parseInt(ev.id) === variantId);
                                
                                return {
                                  id: variantId, // Ensure ID is a number
                                  price: v.price,
                                  // Use compare_at_price from Seal Subscriptions if available, otherwise use existing or price
                                  compare_at_price: (v.compare_at_price !== undefined && v.compare_at_price !== null && v.compare_at_price !== v.price) 
                                    ? v.compare_at_price 
                                    : (existingVariant && existingVariant.compare_at_price && existingVariant.compare_at_price > v.price)
                                      ? existingVariant.compare_at_price
                                      : v.price,
                                  selling_plan_allocations: (v.selling_plan_allocations || []).map(a => ({
                                    selling_plan_id: parseInt(a.selling_plan_id), // Ensure ID is a number
                                    price: a.price,
                                    compare_at_price: a.compare_at_price || a.price
                                  }))
                                };
                              }),
                              selling_plans: sellingPlans.map(plan => ({
                                id: parseInt(plan.id), // Ensure ID is a number
                                name: plan.name,
                                options: plan.options || [],
                                description: plan.description || ''
                              })),
                              groupName: group.name || 'Subscribe & save',
                              intervalLabel: (group.options && group.options[0] && group.options[0].name) || 'Deliver & Pay every'
                            };
                            console.log('[Subscription Picker] Product data updated:', productData);

                            // Update UI with extracted data (this includes prices from Seal Subscriptions)
                            updatePickerFromSealSubs();
                            
                            // Show picker after data is extracted
                            if (picker) {
                              picker.style.display = '';
                              console.log('[Subscription Picker] Showing picker after data extraction');
                              
                              // Update selling plan and prices immediately after showing picker
                              // Prices are updated in updatePickerFromSealSubs(), but also call updatePrices as fallback
                              setTimeout(function() {
                                if (form && productData) {
                                  console.log('[Subscription Picker] Updating selling plan and prices immediately after data extraction');
                                  updatePrices(); // This will set compare_at_price if not already set
                                  updateSellingPlan();
                                  // Also update expandable state after data is loaded
                                  if (typeof updateExpandableState === 'function') {
                                    updateExpandableState();
                                  }
                                }
                              }, 150);
                            }
                            
                            return true;
                          }
                          console.log('[Subscription Picker] No selling plan groups found');
                          return false;
                        }

                        // Update picker UI with Seal Subscriptions data
                        function updatePickerFromSealSubs() {
                          console.log('[Subscription Picker] updatePickerFromSealSubs called');
                          if (!productData || !picker) {
                            console.log('[Subscription Picker] Missing productData or picker');
                            return;
                          }

                          // Update one-time purchase label from Seal Subscriptions
                          const oneTimeLabel = picker.querySelector('[data-one-time-label]');
                          if (oneTimeLabel) {
                            // Find one-time label in Seal Subscriptions (option container with data-one-time-option-radio)
                            const sealSubsOneTimeContainer = document.querySelector('.sls-option-container[data-one-time-option-radio]');
                            if (sealSubsOneTimeContainer) {
                              const sealSubsOneTimeLabelEl = sealSubsOneTimeContainer.querySelector('.sls-selling-plan-group-name');
                              if (sealSubsOneTimeLabelEl) {
                                oneTimeLabel.textContent = sealSubsOneTimeLabelEl.textContent.trim();
                                console.log('[Subscription Picker] Updated one-time label to:', oneTimeLabel.textContent);
                              }
                            }
                          }

                          // Update subscription label from Seal Subscriptions
                          const subscribeLabel = picker.querySelector('[data-subscribe-label]');
                          if (subscribeLabel) {
                            // Find subscription label in Seal Subscriptions (active option container)
                            const sealSubsSubContainer = document.querySelector('.sls-option-container.sls-active[data-selling-plan-group]');
                            if (sealSubsSubContainer) {
                              const sealSubsLabel = sealSubsSubContainer.querySelector('.sls-selling-plan-group-name');
                              if (sealSubsLabel) {
                                // Clone the label element to preserve structure
                                const labelClone = sealSubsLabel.cloneNode(true);
                                // Remove the badge from cloned element if it exists
                                const badgeInClone = labelClone.querySelector('.sls-savings-badge');
                                if (badgeInClone) {
                                  badgeInClone.remove();
                                }
                                // Get clean text without badge
                                let cleanLabelText = labelClone.textContent.trim();
                                // Also try to remove badge text if it's in the text
                                cleanLabelText = cleanLabelText.replace(/\s*SAVE\s+\d+%$/i, '').trim();
                                
                                const savingsBadge = subscribeLabel.querySelector('[data-savings-badge]');
                                subscribeLabel.innerHTML = cleanLabelText;
                                if (savingsBadge) {
                                  subscribeLabel.appendChild(savingsBadge);
                                }
                                console.log('[Subscription Picker] Updated subscribe label to:', cleanLabelText);
                              }
                            } else if (productData.groupName) {
                              const savingsBadge = subscribeLabel.querySelector('[data-savings-badge]');
                              subscribeLabel.innerHTML = productData.groupName;
                              if (savingsBadge) {
                                subscribeLabel.appendChild(savingsBadge);
                              }
                            }
                          }

                          // Update savings badge from Seal Subscriptions
                          const savingsBadge = picker.querySelector('[data-savings-badge]');
                          if (savingsBadge) {
                            const sealSubsBadge = document.querySelector('.sls-savings-badge');
                            if (sealSubsBadge) {
                              savingsBadge.textContent = sealSubsBadge.textContent.trim();
                            }
                          }

                          // Update interval label from Seal Subscriptions
                          const intervalLabel = picker.querySelector('[data-interval-label]');
                          if (intervalLabel) {
                            const sealSubsIntervalLabel = document.querySelector('.selling-plan-group-options-name-select label');
                            if (sealSubsIntervalLabel) {
                              intervalLabel.textContent = sealSubsIntervalLabel.textContent.trim();
                            } else if (productData.intervalLabel) {
                              intervalLabel.textContent = productData.intervalLabel;
                            }
                          }

                          // Update interval select options from Seal Subscriptions
                          const intervalSelect = picker.querySelector('[data-interval-select]');
                          if (intervalSelect) {
                            const sealSubsSelect = document.querySelector('.sls-select[name="subs_interval"]');
                            if (sealSubsSelect && sealSubsSelect.options.length > 0) {
                              intervalSelect.innerHTML = '';
                              Array.from(sealSubsSelect.options).forEach((option, index) => {
                                const newOption = document.createElement('option');
                                newOption.value = option.value;
                                newOption.dataset.planId = option.value;
                                newOption.textContent = option.textContent.trim();
                                if (index === 0) newOption.selected = true;
                                intervalSelect.appendChild(newOption);
                              });
                            } else if (productData.selling_plans.length > 0) {
                              intervalSelect.innerHTML = '';
                              productData.selling_plans.forEach((plan, index) => {
                                const option = document.createElement('option');
                                option.value = plan.id;
                                option.dataset.planId = plan.id;
                                option.textContent = plan.options[0]?.value || plan.name;
                                if (index === 0) option.selected = true;
                                intervalSelect.appendChild(option);
                              });
                            }
                          }

                          // Update prices from Seal Subscriptions immediately
                          const oneTimePriceEl = picker.querySelector('[data-one-time-price]');
                          const oneTimeCompareEl = picker.querySelector('[data-one-time-compare]');
                          const subscriptionPriceEl = picker.querySelector('[data-subscription-price]');
                          const subscriptionCompareEl = picker.querySelector('[data-subscription-compare]');
                          
                          // Update one-time price from Seal Subscriptions
                          if (oneTimePriceEl) {
                            const sealSubsOneTimePrice = document.querySelector('.sls-one-time-price .sls-price .money');
                            if (sealSubsOneTimePrice) {
                              oneTimePriceEl.innerHTML = sealSubsOneTimePrice.outerHTML;
                              console.log('[Subscription Picker] Updated one-time price from Seal Subscriptions');
                            }
                          }
                          if (oneTimeCompareEl) {
                            const sealSubsOneTimeCompare = document.querySelector('.sls-one-time-price .sls-original-price .money');
                            if (sealSubsOneTimeCompare) {
                              oneTimeCompareEl.innerHTML = sealSubsOneTimeCompare.outerHTML;
                              oneTimeCompareEl.style.display = '';
                              console.log('[Subscription Picker] Updated one-time compare price from Seal Subscriptions');
                            } else if (productData && productData.variants.length > 0) {
                              // Fallback: use variant compare_at_price from productData
                              const variant = productData.variants[0];
                              if (variant.compare_at_price && variant.compare_at_price > variant.price) {
                                const comparePriceCents = variant.compare_at_price;
                                const comparePriceFormatted = formatMoney(comparePriceCents);
                                oneTimeCompareEl.innerHTML = '<span class="money">' + comparePriceFormatted + '</span>';
                                oneTimeCompareEl.style.display = '';
                                console.log('[Subscription Picker] Updated one-time compare price from productData');
                              } else {
                                oneTimeCompareEl.style.display = 'none';
                              }
                            }
                          }
                          
                          // Update subscription price from Seal Subscriptions (only once, don't change on interval change)
                          if (subscriptionPriceEl) {
                            const sealSubsSubPrice = document.querySelector('.sls-selling-plan-group-price .sls-price .money');
                            if (sealSubsSubPrice) {
                              subscriptionPriceEl.innerHTML = sealSubsSubPrice.outerHTML;
                              console.log('[Subscription Picker] Updated subscription price from Seal Subscriptions');
                            }
                          }
                          if (subscriptionCompareEl) {
                            const sealSubsSubCompare = document.querySelector('.sls-selling-plan-group-price .sls-original-price .money');
                            if (sealSubsSubCompare) {
                              subscriptionCompareEl.innerHTML = sealSubsSubCompare.outerHTML;
                              subscriptionCompareEl.style.display = '';
                              console.log('[Subscription Picker] Updated subscription compare price from Seal Subscriptions');
                            }
                          }

                          // Update subscription benefits/description from Seal Subscriptions
                          // Only if custom benefits are not enabled
                          const benefitsEl = picker.querySelector('[data-subscription-benefits]');
                          if (benefitsEl) {
                            const useCustomBenefits = picker.dataset.useCustomBenefits === 'true';
                            
                            if (!useCustomBenefits) {
                              const sealSubsDescription = document.querySelector('.sls-selling-plan-description-content');
                              if (sealSubsDescription) {
                                // Convert description to list format with checkmarks
                                const descriptionText = sealSubsDescription.textContent.trim();
                                if (descriptionText) {
                                  // Try to split by sentences or new lines
                                  const sentences = descriptionText.split(/[.!?]\s+/).filter(s => s.trim().length > 0);
                                  if (sentences.length > 0) {
                                    let listHtml = '<ul>';
                                    sentences.forEach(sentence => {
                                      listHtml += '<li>' + sentence.trim() + '</li>';
                                    });
                                    listHtml += '</ul>';
                                    benefitsEl.innerHTML = listHtml;
                                  } else {
                                    benefitsEl.innerHTML = '<p>' + descriptionText + '</p>';
                                  }
                                }
                              } else if (productData.selling_plans.length > 0) {
                                const description = productData.selling_plans[0].description || '';
                                if (description) {
                                  const sentences = description.split(/[.!?]\s+/).filter(s => s.trim().length > 0);
                                  if (sentences.length > 0) {
                                    let listHtml = '<ul>';
                                    sentences.forEach(sentence => {
                                      listHtml += '<li>' + sentence.trim() + '</li>';
                                    });
                                    listHtml += '</ul>';
                                    benefitsEl.innerHTML = listHtml;
                                  } else {
                                    benefitsEl.innerHTML = '<p>' + description + '</p>';
                                  }
                                }
                              }
                            } else {
                              console.log('[Subscription Picker] Using custom benefits, keeping original content');
                            }
                            // If custom benefits are enabled, keep the original content from Liquid
                          }

                          // Update subscription details from Seal Subscriptions
                          const detailsContent = picker.querySelector('[data-subscription-details]');
                          if (detailsContent) {
                            const sealSubsDetails = document.querySelector('.sls-more-info-popup-content');
                            if (sealSubsDetails) {
                              detailsContent.innerHTML = sealSubsDetails.innerHTML;
                            }
                          }
                        }

                        // Update selling plan input
                        function updateSellingPlan() {
                          console.log('[Subscription Picker] updateSellingPlan called');
                          if (!picker || !form) {
                            console.log('[Subscription Picker] Missing picker or form in updateSellingPlan');
                            return;
                          }
                          const selectedOption = picker.querySelector('.subscription-radio:checked');
                          if (!selectedOption || !sellingPlanInput) {
                            console.log('[Subscription Picker] No selected option or sellingPlanInput');
                            return;
                          }

                          const currentIntervalSelect = picker.querySelector('[data-interval-select]');
                          if (selectedOption.value === 'subscription' && currentIntervalSelect) {
                            const planId = currentIntervalSelect.options[currentIntervalSelect.selectedIndex].dataset.planId;
                            console.log('[Subscription Picker] Setting selling plan ID:', planId);
                            if (sellingPlanInput) {
                              sellingPlanInput.value = planId || '';
                              console.log('[Subscription Picker] sellingPlanInput.value set to:', sellingPlanInput.value);
                            } else {
                              console.error('[Subscription Picker] sellingPlanInput is null!');
                            }
                            
                            // Also update Seal Subscriptions hidden input if it exists and is different
                            const sealSubsSellingPlanInput = form.querySelector('[data-sls-selling_plan]');
                            if (sealSubsSellingPlanInput && sealSubsSellingPlanInput !== sellingPlanInput) {
                              sealSubsSellingPlanInput.value = planId || '';
                              console.log('[Subscription Picker] Also updated Seal Subscriptions input');
                            }
                          } else {
                            console.log('[Subscription Picker] Clearing selling plan (one-time purchase)');
                            if (sellingPlanInput) {
                              sellingPlanInput.value = '';
                              console.log('[Subscription Picker] sellingPlanInput.value cleared');
                            }
                            
                            // Also update Seal Subscriptions hidden input if it exists and is different
                            const sealSubsSellingPlanInput = form.querySelector('[data-sls-selling_plan]');
                            if (sealSubsSellingPlanInput && sealSubsSellingPlanInput !== sellingPlanInput) {
                              sealSubsSellingPlanInput.value = '';
                            }
                          }
                          
                          // Log final state for debugging
                          console.log('[Subscription Picker] Final selling_plan inputs in form:');
                          const allSellingPlanInputs = form.querySelectorAll('[name="selling_plan"]');
                          allSellingPlanInputs.forEach((input, index) => {
                            console.log('[Subscription Picker] Input', index + ':', input, 'value:', input.value, 'id:', input.id);
                          });
                        }

                        // Format money helper
                        function formatMoney(cents) {
                          if (typeof theme !== 'undefined' && theme.moneyFormat) {
                            const amountPlaceholder = String.fromCharCode(123, 123) + 'amount' + String.fromCharCode(125, 125);
                            return theme.moneyFormat.replace(amountPlaceholder, (cents / 100).toFixed(2));
                          }
                          const currencyCode = '{{ cart.currency.iso_code }}';
                          const amount = (cents / 100).toFixed(2);
                          if (currencyCode === 'EUR') {
                            return amount.replace('.', ',') + ' ' + currencyCode;
                          }
                          return amount + ' ' + currencyCode;
                        }

                        // Debounce for updatePrices to avoid multiple calls
                        let updatePricesTimeout = null;
                        
                        // Update prices
                        function updatePrices() {
                          console.log('[Subscription Picker] updatePrices called');
                          if (!form || !productData || !picker) {
                            console.log('[Subscription Picker] Missing form, productData or picker in updatePrices');
                            return;
                          }
                          
                          // Clear previous timeout
                          if (updatePricesTimeout) {
                            clearTimeout(updatePricesTimeout);
                          }
                          
                          // Debounce update to avoid race conditions
                          updatePricesTimeout = setTimeout(function() {
                            updatePricesImmediate();
                          }, 50);
                        }
                        
                        function updatePricesImmediate() {
                          console.log('[Subscription Picker] updatePricesImmediate called');
                          if (!form || !productData || !picker) {
                            console.log('[Subscription Picker] Missing form, productData or picker in updatePricesImmediate');
                            return;
                          }
                          const variantIdInput = form.querySelector('[name="id"]');
                          if (!variantIdInput || !variantIdInput.value) {
                            console.log('[Subscription Picker] No variant ID input or value');
                            return;
                          }
                          
                          const variantId = parseInt(variantIdInput.value);
                          console.log('[Subscription Picker] Current variant ID:', variantId, 'Type:', typeof variantId);
                          console.log('[Subscription Picker] Available variant IDs:', productData.variants.map(v => ({ id: v.id, type: typeof v.id })));
                          const variant = productData.variants.find(v => {
                            // Ensure both IDs are numbers for comparison
                            const vId = typeof v.id === 'string' ? parseInt(v.id) : (typeof v.id === 'number' ? v.id : parseInt(v.id));
                            const compareId = typeof variantId === 'string' ? parseInt(variantId) : variantId;
                            const match = vId === compareId;
                            if (match) {
                              console.log('[Subscription Picker] Variant match found:', vId, '===', compareId);
                            }
                            return match;
                          });
                          if (!variant) {
                            console.warn('[Subscription Picker] Variant not found in productData. Looking for:', variantId);
                            console.log('[Subscription Picker] ProductData variants:', productData.variants);
                            // Try to find by string comparison as fallback
                            const variantStr = productData.variants.find(v => String(v.id) === String(variantId));
                            if (variantStr) {
                              console.log('[Subscription Picker] Found variant by string comparison');
                              return; // Still return to avoid errors, but log the issue
                            }
                            return;
                          }
                          console.log('[Subscription Picker] Found variant:', variant);

                          const selectedOption = picker.querySelector('.subscription-radio:checked');
                          if (!selectedOption) return;

                          const oneTimePriceEl = picker.querySelector('[data-one-time-price]');
                          const oneTimeCompareEl = picker.querySelector('[data-one-time-compare]');
                          const subscriptionPriceEl = picker.querySelector('[data-subscription-price]');
                          const subscriptionCompareEl = picker.querySelector('[data-subscription-compare]');
                          const currentIntervalSelect = picker.querySelector('[data-interval-select]');

                          // Update one-time price - always use variant price from productData (not Seal Subscriptions DOM)
                          // This ensures correct price for current variant without delay
                          if (oneTimePriceEl) {
                            const priceCents = variant.price;
                            const priceFormatted = formatMoney(priceCents);
                            oneTimePriceEl.innerHTML = '<span class="money">' + priceFormatted + '</span>';
                            console.log('[Subscription Picker] Updated one-time price to:', priceFormatted, 'for variant:', variantId);
                          }
                          // Update one-time compare price - always use variant compare_at_price from productData
                          // Always update, even if compare_at_price equals price (then hide it)
                          if (oneTimeCompareEl) {
                            console.log('[Subscription Picker] Checking compare_at_price for variant:', variantId, 'compare_at_price:', variant.compare_at_price, 'price:', variant.price);
                            // Always clear and update, don't rely on previous state
                            if (variant.compare_at_price && variant.compare_at_price > variant.price) {
                              const comparePriceCents = variant.compare_at_price;
                              const comparePriceFormatted = formatMoney(comparePriceCents);
                              oneTimeCompareEl.innerHTML = '<span class="money">' + comparePriceFormatted + '</span>';
                              oneTimeCompareEl.style.display = '';
                              console.log('[Subscription Picker] Updated one-time compare price to:', comparePriceFormatted, 'for variant:', variantId);
                            } else {
                              // Clear content and hide if compare_at_price is not greater than price
                              oneTimeCompareEl.innerHTML = '';
                              oneTimeCompareEl.style.display = 'none';
                              console.log('[Subscription Picker] Hiding one-time compare price (compare_at_price:', variant.compare_at_price, '<= price:', variant.price, ')');
                            }
                          }

                          // Update subscription price - always update based on current variant and selected selling plan
                          // Prices should change when variant changes, but not when interval changes
                          if (selectedOption.value === 'subscription' && subscriptionPriceEl && currentIntervalSelect && variant.selling_plan_allocations) {
                            // Get selected selling plan ID from interval select
                            const planIdStr = currentIntervalSelect.options[currentIntervalSelect.selectedIndex]?.dataset.planId;
                            if (planIdStr) {
                              const planId = parseInt(planIdStr);
                              console.log('[Subscription Picker] Looking for selling plan allocation with ID:', planId, 'for variant:', variantId);
                              
                              // Find allocation for current variant and selected selling plan
                              const allocation = variant.selling_plan_allocations.find(a => {
                                const aId = typeof a.selling_plan_id === 'string' ? parseInt(a.selling_plan_id) : (typeof a.selling_plan_id === 'number' ? a.selling_plan_id : parseInt(a.selling_plan_id));
                                const compareId = typeof planId === 'string' ? parseInt(planId) : planId;
                                return aId === compareId;
                              });
                              
                              if (allocation) {
                                console.log('[Subscription Picker] Found allocation for variant:', allocation);
                                const subPriceCents = allocation.price;
                                const subPriceFormatted = formatMoney(subPriceCents);
                                subscriptionPriceEl.innerHTML = '<span class="money">' + subPriceFormatted + '</span>';
                              } else {
                                console.warn('[Subscription Picker] Allocation not found for plan ID:', planId, 'in variant:', variantId);
                                // Try to get from Seal Subscriptions as fallback
                                const sealSubsSubPrice = document.querySelector('.sls-selling-plan-group-price .sls-price .money');
                                if (sealSubsSubPrice) {
                                  subscriptionPriceEl.innerHTML = sealSubsSubPrice.outerHTML;
                                }
                              }
                            } else {
                              // Fallback: try to get from Seal Subscriptions
                              const sealSubsSubPrice = document.querySelector('.sls-selling-plan-group-price .sls-price .money');
                              if (sealSubsSubPrice) {
                                subscriptionPriceEl.innerHTML = sealSubsSubPrice.outerHTML;
                              }
                            }

                            // Update subscription compare price
                            if (subscriptionCompareEl) {
                              const planIdStr = currentIntervalSelect.options[currentIntervalSelect.selectedIndex]?.dataset.planId;
                              if (planIdStr) {
                                const planId = parseInt(planIdStr);
                                const allocation = variant.selling_plan_allocations.find(a => {
                                  const aId = typeof a.selling_plan_id === 'string' ? parseInt(a.selling_plan_id) : (typeof a.selling_plan_id === 'number' ? a.selling_plan_id : parseInt(a.selling_plan_id));
                                  const compareId = typeof planId === 'string' ? parseInt(planId) : planId;
                                  return aId === compareId;
                                });
                                if (allocation && allocation.compare_at_price && allocation.compare_at_price > allocation.price) {
                                  const subComparePriceCents = allocation.compare_at_price;
                                  const subComparePriceFormatted = formatMoney(subComparePriceCents);
                                  subscriptionCompareEl.innerHTML = '<span class="money">' + subComparePriceFormatted + '</span>';
                                  subscriptionCompareEl.style.display = '';
                                } else {
                                  // Try to get from Seal Subscriptions as fallback
                                  const sealSubsSubCompare = document.querySelector('.sls-selling-plan-group-price .sls-original-price .money');
                                  if (sealSubsSubCompare) {
                                    subscriptionCompareEl.innerHTML = sealSubsSubCompare.outerHTML;
                                    subscriptionCompareEl.style.display = '';
                                  } else {
                                    subscriptionCompareEl.style.display = 'none';
                                  }
                                }
                              }
                            }
                          }
                        }

                        function initSubscriptionPicker() {
                          console.log('[Subscription Picker] initSubscriptionPicker called, isInitialized:', isInitialized);
                          if (isInitialized || !picker || !picker.parentNode) {
                            console.log('[Subscription Picker] Already initialized or picker removed');
                            return;
                          }

                          form = document.getElementById(formId);
                          if (!form) {
                            console.log('[Subscription Picker] Form not found:', formId);
                            return;
                          }
                          console.log('[Subscription Picker] Form found:', form);

                          // Hide Seal Subscriptions block
                          hideSealSubscriptions();

                          // Initialize productData with default data from Liquid first
                          // This ensures we have compare_at_price values even if Seal Subscriptions doesn't provide them
                          if (!productData) {
                            productData = {
                              variants: [
                                {% for variant in product.variants %}
                                {
                                  id: {{ variant.id }},
                                  price: {{ variant.price }},
                                  compare_at_price: {{ variant.compare_at_price | default: variant.price }},
                                  selling_plan_allocations: [
                                    {% for allocation in variant.selling_plan_allocations %}
                                    {
                                      selling_plan_id: {{ allocation.selling_plan.id }},
                                      price: {{ allocation.price }},
                                      compare_at_price: {{ allocation.compare_at_price | default: allocation.price }}
                                    }{% unless forloop.last %},{% endunless %}
                                    {% endfor %}
                                  ]
                                }{% unless forloop.last %},{% endunless %}
                                {% endfor %}
                              ],
                              selling_plans: [
                                {%- if first_group and first_group.selling_plans -%}
                                  {% for plan in first_group.selling_plans %}
                                  {
                                    id: {{ plan.id }},
                                    name: {{ plan.name | json }},
                                    options: [
                                      {% for option in plan.options %}
                                      {
                                        name: {{ option.name | json }},
                                        value: {{ option.value | json }}
                                      }{% unless forloop.last %},{% endunless %}
                                      {% endfor %}
                                    ]
                                  }{% unless forloop.last %},{% endunless %}
                                  {% endfor %}
                                {%- endif -%}
                              ]
                            };
                            console.log('[Subscription Picker] Initialized productData from Liquid:', productData);
                          }

                          // Try to extract data from Seal Subscriptions and update productData
                          // This will preserve compare_at_price from initial productData if not in Seal Subscriptions
                          const hasSealSubsData = extractDataFromSealSubs();
                          console.log('[Subscription Picker] Has Seal Subscriptions data:', hasSealSubsData);

                          // Check for existing selling_plan input (from Seal Subscriptions or our own)
                          // Find or create selling_plan input
                          // First check for Seal Subscriptions input
                          let sealSubsInput = form.querySelector('[data-sls-selling_plan]');
                          if (sealSubsInput) {
                            console.log('[Subscription Picker] Found Seal Subscriptions selling_plan input, using it');
                            sellingPlanInput = sealSubsInput;
                          } else {
                            // Check for any existing selling_plan input
                            sellingPlanInput = form.querySelector('[name="selling_plan"]');
                            if (!sellingPlanInput) {
                              console.log('[Subscription Picker] Creating new selling_plan input');
                              sellingPlanInput = document.createElement('input');
                              sellingPlanInput.type = 'hidden';
                              sellingPlanInput.name = 'selling_plan';
                              sellingPlanInput.id = 'selling_plan_' + blockId;
                              // Insert before submit button or at the end of form
                              const submitButton = form.querySelector('button[type="submit"]');
                              if (submitButton) {
                                submitButton.parentNode.insertBefore(sellingPlanInput, submitButton);
                              } else {
                                form.appendChild(sellingPlanInput);
                              }
                            } else {
                              console.log('[Subscription Picker] Found existing selling_plan input:', sellingPlanInput);
                            }
                          }
                          console.log('[Subscription Picker] sellingPlanInput:', sellingPlanInput, 'Current value:', sellingPlanInput.value);
                          
                          const radioButtons = picker.querySelectorAll('.subscription-radio');
                          intervalSelect = picker.querySelector('[data-interval-select]');
                          const options = picker.querySelectorAll('.subscription-option');

                          // Function to update expandable state (only for opacity and margin, max-height handled by CSS)
                          function updateExpandableState() {
                            options.forEach(opt => {
                              const expandable = opt.querySelector('.subscription-option__expandable');
                              if (expandable) {
                                // Remove any inline styles that might interfere
                                expandable.style.maxHeight = '';
                                if (opt.classList.contains('subscription-option--active')) {
                                  // Show expandable content (max-height handled by CSS)
                                  expandable.style.opacity = '1';
                                  expandable.style.marginTop = '16px';
                                } else {
                                  // Hide expandable content (max-height handled by CSS)
                                  expandable.style.opacity = '0';
                                  expandable.style.marginTop = '0';
                                }
                              }
                            });
                          }

                          // Event listeners
                          console.log('[Subscription Picker] Setting up event listeners, radio buttons:', radioButtons.length);
                          
                          // Set initial state - CSS handles max-height, we only set opacity and margin
                          setTimeout(function() {
                            updateExpandableState();
                          }, 100);
                          
                          radioButtons.forEach(radio => {
                            radio.addEventListener('change', function() {
                              console.log('[Subscription Picker] Radio changed to:', this.value);
                              options.forEach(opt => opt.classList.remove('subscription-option--active'));
                              this.closest('.subscription-option').classList.add('subscription-option--active');
                              
                              // Update expandable content with smooth animation
                              updateExpandableState();
                              
                              updateSellingPlan();
                              updatePrices();
                              
                              // Sync with Seal Subscriptions
                              const sealSubsRadios = document.querySelectorAll('.sls-option[data-type]');
                              if (this.value === 'one-time') {
                                const sealSubsOneTime = Array.from(sealSubsRadios).find(r => r.dataset.type === 'one_time');
                                if (sealSubsOneTime) {
                                  console.log('[Subscription Picker] Syncing with Seal Subscriptions one-time');
                                  sealSubsOneTime.checked = true;
                                  sealSubsOneTime.dispatchEvent(new Event('change', { bubbles: true }));
                                }
                              } else if (this.value === 'subscription') {
                                const sealSubsSub = Array.from(sealSubsRadios).find(r => r.dataset.type === 'subscription');
                                if (sealSubsSub) {
                                  console.log('[Subscription Picker] Syncing with Seal Subscriptions subscription');
                                  sealSubsSub.checked = true;
                                  sealSubsSub.dispatchEvent(new Event('change', { bubbles: true }));
                                }
                              }
                            });
                          });

                          // Add click handlers to subscription options (blocks)
                          console.log('[Subscription Picker] Setting up click handlers on subscription options, count:', options.length);
                          options.forEach(option => {
                            option.addEventListener('click', function(e) {
                              // Don't trigger if clicking on radio, label, select, or button
                              if (e.target.closest('.subscription-radio') || 
                                  e.target.closest('label') || 
                                  e.target.closest('select') ||
                                  e.target.closest('button') ||
                                  e.target.tagName === 'BUTTON') {
                                console.log('[Subscription Picker] Click ignored - clicked on interactive element');
                                return;
                              }
                              
                              console.log('[Subscription Picker] Option block clicked:', this);
                              const radio = this.querySelector('.subscription-radio');
                              if (radio) {
                                console.log('[Subscription Picker] Triggering radio change, current value:', radio.value);
                                radio.checked = true;
                                // Trigger change event to update selling plan and prices
                                const changeEvent = new Event('change', { bubbles: true });
                                radio.dispatchEvent(changeEvent);
                              } else {
                                console.warn('[Subscription Picker] No radio found in option block');
                              }
                            });
                          });

                          if (intervalSelect) {
                            console.log('[Subscription Picker] Setting up interval select listener');
                            intervalSelect.addEventListener('change', function() {
                              console.log('[Subscription Picker] Interval changed to:', this.value);
                              updateSellingPlan();
                              // Don't update prices when interval changes - prices stay the same
                              
                              // Sync with Seal Subscriptions interval select
                              const sealSubsInterval = document.querySelector('.sls-select[name="subs_interval"]');
                              if (sealSubsInterval) {
                                console.log('[Subscription Picker] Syncing interval with Seal Subscriptions');
                                sealSubsInterval.value = this.value;
                                sealSubsInterval.dispatchEvent(new Event('change', { bubbles: true }));
                              }
                            });
                          } else {
                            console.log('[Subscription Picker] No interval select found');
                          }

                          // Listen for variant changes
                          const productSection = form.closest('.js-product');
                          if (productSection) {
                            console.log('[Subscription Picker] Setting up variant change listener');
                            productSection.addEventListener('on:variant:change', function(evt) {
                              console.log('[Subscription Picker] Variant changed event:', evt.detail);
                              if (evt.detail && evt.detail.variant) {
                                updatePrices();
                              }
                            });
                          }

                          const variantInput = form.querySelector('[name="id"]');
                          if (variantInput) {
                            console.log('[Subscription Picker] Setting up variant input observer');
                            variantInput.addEventListener('change', function() {
                              console.log('[Subscription Picker] Variant input changed');
                              updatePrices();
                            });
                            const observer = new MutationObserver(function() {
                              console.log('[Subscription Picker] Variant input mutation detected');
                              updatePrices();
                            });
                            observer.observe(variantInput, { attributes: true, attributeFilter: ['value'] });
                          }

                          // Mark as initialized
                          isInitialized = true;
                          console.log('[Subscription Picker] Initialization complete');
                          
                          // Update prices and selling plan immediately after initialization
                          if (productData && form) {
                            console.log('[Subscription Picker] Updating prices and selling plan after initialization');
                            // Small delay to ensure all DOM elements are ready
                            setTimeout(function() {
                              updatePrices();
                              updateSellingPlan();
                              // Also update expandable state
                              updateExpandableState();
                            }, 50);
                          }
                        }

                        // Setup MutationObserver on buy-buttons container
                        function setupObserver() {
                          console.log('[Subscription Picker] setupObserver called, observerActive:', observerActive);
                          if (observerActive) {
                            console.log('[Subscription Picker] Observer already active, skipping');
                            return;
                          }
                          
                          const buyButtonsContainer = picker.closest('buy-buttons') || picker.parentElement;
                          if (!buyButtonsContainer) {
                            console.log('[Subscription Picker] Buy buttons container not found, retrying...');
                            setTimeout(setupObserver, 100);
                            return;
                          }
                          console.log('[Subscription Picker] Buy buttons container found:', buyButtonsContainer);

                          observerActive = true;

                          // Debounce function to prevent too frequent updates
                          let updateTimeout = null;
                          let lastUpdateTime = 0;
                          const UPDATE_DEBOUNCE_MS = 500; // Wait 500ms before processing updates

                          // Create observer for Seal Subscriptions injection
                          const sealSubsObserver = new MutationObserver(function(mutations) {
                            // Filter out mutations that are not relevant
                            const relevantMutations = mutations.filter(function(mutation) {
                              // Only process if Seal Subscriptions elements are involved
                              if (mutation.addedNodes.length > 0) {
                                for (let i = 0; i < mutation.addedNodes.length; i++) {
                                  const node = mutation.addedNodes[i];
                                  if (node.nodeType === 1 && node.classList) {
                                    if (node.classList.contains('sealsubs-target-element') ||
                                        node.classList.contains('sealsubs-container') ||
                                        node.querySelector('.sealsubs-target-element')) {
                                      return true;
                                    }
                                  }
                                }
                              }
                              // Process data-product attribute changes
                              if (mutation.type === 'attributes' && mutation.attributeName === 'data-product') {
                                return true;
                              }
                              return false;
                            });

                            if (relevantMutations.length === 0) {
                              return; // Skip if no relevant mutations
                            }

                            console.log('[Subscription Picker] MutationObserver triggered, relevant mutations:', relevantMutations.length);
                            
                            // Clear previous timeout
                            if (updateTimeout) {
                              clearTimeout(updateTimeout);
                            }

                            // Debounce the update
                            const now = Date.now();
                            const timeSinceLastUpdate = now - lastUpdateTime;
                            
                            updateTimeout = setTimeout(function() {
                              console.log('[Subscription Picker] Processing update after debounce');
                              lastUpdateTime = Date.now();
                              
                              // Hide Seal Subscriptions
                              hideSealSubscriptions();
                              
                              // Extract and update data
                              if (extractDataFromSealSubs()) {
                                // Show picker (already done in extractDataFromSealSubs, but ensure it's visible)
                                if (picker) {
                                  picker.style.display = '';
                                }
                                
                                if (!isInitialized) {
                                  console.log('[Subscription Picker] Initializing picker after data extraction');
                                  initSubscriptionPicker();
                                } else {
                                  console.log('[Subscription Picker] Updating prices and selling plan');
                                  updatePrices();
                                  updateSellingPlan();
                                }
                              }
                            }, timeSinceLastUpdate < UPDATE_DEBOUNCE_MS ? UPDATE_DEBOUNCE_MS - timeSinceLastUpdate : 100);
                          });

                          // Observe buy-buttons container for changes
                          console.log('[Subscription Picker] Starting to observe buy-buttons container');
                          sealSubsObserver.observe(buyButtonsContainer, {
                            childList: true,
                            subtree: true,
                            attributes: true,
                            attributeFilter: ['data-product', 'class']
                          });

                          // Also hide Seal Subscriptions immediately if already present
                          hideSealSubscriptions();
                          
                          // Try to extract data if Seal Subscriptions is already injected
                          const sealSubsElement = document.querySelector('.sealsubs-target-element.sealsubs-full[data-product]');
                          if (sealSubsElement) {
                            console.log('[Subscription Picker] Seal Subscriptions already present, extracting data');
                            hideSealSubscriptions();
                            if (extractDataFromSealSubs()) {
                              // Show picker (already done in extractDataFromSealSubs, but ensure it's visible)
                              if (picker) {
                                picker.style.display = '';
                              }
                              // Wait a bit before initializing to ensure DOM is ready
                              setTimeout(function() {
                                initSubscriptionPicker();
                              }, 100);
                            }
                          } else {
                            console.log('[Subscription Picker] Seal Subscriptions not found yet');
                          }
                        }

                        // Initialize when DOM is ready
                        console.log('[Subscription Picker] DOM ready state:', document.readyState);
                        if (document.readyState === 'loading') {
                          console.log('[Subscription Picker] Waiting for DOMContentLoaded');
                          document.addEventListener('DOMContentLoaded', function() {
                            console.log('[Subscription Picker] DOMContentLoaded fired');
                            setupObserver();
                            setTimeout(function() {
                              console.log('[Subscription Picker] Initializing picker after delay');
                              initSubscriptionPicker();
                            }, 300);
                          });
                        } else {
                          console.log('[Subscription Picker] DOM already ready, initializing immediately');
                          setupObserver();
                          setTimeout(function() {
                            console.log('[Subscription Picker] Initializing picker after delay');
                            initSubscriptionPicker();
                          }, 300);
                        }
                        console.log('[Subscription Picker] Script setup complete');
                      })();
                    </script>

                    <style>
                      /* Hide Seal Subscriptions block */
                      .sealsubs-target-element.sealsubs-full,
                      .sealsubs-container {
                        display: none !important;
                        visibility: hidden !important;
                        opacity: 0 !important;
                        height: 0 !important;
                        overflow: hidden !important;
                      }

                      .custom-subscription-picker {
                        margin-bottom: 24px;
                      }

                      .subscription-picker__title {
                        font-size: 18px;
                        font-weight: 700;
                        margin-bottom: 20px;
                        text-align: center;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                      }

                      .subscription-picker__options {
                        display: flex;
                        flex-direction: column-reverse;
                        gap: 8px;
                      }

                      .subscription-option {
                        position: relative;
                        border: 1.5px solid #E9EBE9;
                        border-radius: 12px;
                        padding: 12px 16px;
                        background: #FFFFFF;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        gap: 16px;
                        align-items: flex-start;
                      }

                      .subscription-option:hover {
                        border-color: #CCCCE8;
                      }

                      .subscription-option--active {
                        border-color: #7B68EE;
                        background: #F5F3FF;
                      }

                      .subscription-option--subscribe.subscription-option--active {
                        border-color: #B4B4DE;
                        background: #F1F1F9;
                      }


                      .subscription-option__radio {
                        position: relative;
                        flex-shrink: 0;
                        margin-top: 2px;
                      }
                     

                      .subscription-radio {
                        position: absolute;
                        opacity: 0;
                        cursor: pointer;
                      }

                      .subscription-radio-custom {
                        display: block;
                        width: 20px;
                        height: 20px;
                        border: 2px solid #CCCCE8;
                        border-radius: 50%;
                        background: white;
                        position: relative;
                        transition: all 0.3s ease;
                      }

                      .subscription-radio:checked + .subscription-radio-custom {
                        border-color: #1A365D;
                        background: #1A365D;
                      }

                      .subscription-radio:checked + .subscription-radio-custom::after {
                        content: '';
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        width: 8px;
                        height: 8px;
                        background: white;
                        border-radius: 50%;
                      }

                      .subscription-option__content {
                        flex: 1;
                        min-width: 0;
                      }

                      .subscription-option__label {
                        display: flex;
                        gap: 8px;
                        flex-wrap: wrap;
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 0;
                        cursor: pointer;
                        color: #1D211E;



                        font-family: "Avenir Next";
                        font-weight: 600;
                        font-style: Medium;
                        font-size: 16px;
                        line-height: 150%;
                        letter-spacing: 0%;
                        vertical-align: middle;

                      }

                      .subscription-savings-badge {
                        display: inline-block;
                        background: #E98C36;
                        color: white;
                        padding: 3px 12px;
                        border-radius: 48px;
                        font-family: "Gotham";
                        font-weight: 700;
                        font-style: Bold;
                        font-size: 12px;
                        line-height: 150%;
                        letter-spacing: 0%;

                      }

                      .subscription-option__price {
                        margin-bottom: 16px;
                      }

                      .subscription-price {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        flex-wrap: wrap;
                        justify-content: flex-end;
                      }

                      .subscription-option__expandable {
                        max-height: 0;
                        overflow: hidden;
                        opacity: 0;
                        transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                                    opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                                    margin-top 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                        margin-top: 0;


                        display: flex;
                        flex-direction: row-reverse;
                      }

                      .subscription-option--active .subscription-option__expandable {
                        max-height: 2000px;
                        opacity: 1;
                        margin-top: 16px;
                      }

                      .subscription-option__interval {
                        margin-bottom: 16px;
                      }

                      .subscription-interval-label {
                        display: block;
                        font-size: 14px;
                        color: #666;
                        margin-bottom: 8px;
                      }

                      .subscription-interval-select {
                        width: 100%;
                        padding: 10px 12px;
                        border: 1px solid #E8E8E8;
                        border-radius: 8px;
                        background: #F8F8F8;
                        font-size: 14px;
                        cursor: pointer;
                        width: 136px;
                        appearance: none;
                        background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L6 6L11 1' stroke='%231A365D' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
                        background-repeat: no-repeat;
                        background-position: right 12px center;
                        padding-right: 36px;
                      }

                      .subscription-option__benefits {
                        margin-top: 12px;
                        font-size: 14px;
                        line-height: 1.6;
                      }

                      .subscription-option__benefits ul {
                        list-style: none;
                        padding: 0;
                        margin: 0;
                      }

                      .subscription-option__benefits li {
                        display: flex;
                        align-items: flex-start;
                        gap: 4px;
                        margin-bottom: 12px;
                        position: relative;

                        font-family: "Gotham";
                        font-weight: 400;
                        font-style: Book;
                        font-size: 12px;
                        line-height: 150%;
                        letter-spacing: 0%;
                        vertical-align: middle;
                        color: #232323BF;

                      }

                      /* Default checkmark icon if no custom icon */
                      .subscription-option__benefits li::before {
                        content: '';
                        flex-shrink: 0;
                        margin-top: 2px;
                        width: 20px;
                        height: 20px;
                        display: block;
                        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzLjMzMzMgNEw1Ljk5OTk2IDExLjMzMzNMMi42NjY2MyA4IiBzdHJva2U9IiMxQTM2NUQiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==");
                        background-size: 16px 16px;
                        background-repeat: no-repeat;
                        background-position: center;
                        border-radius: 50%;
                      }

                      /* Hide default checkmark if custom icon/SVG is present */
                      .subscription-option__benefits li:has(svg)::before {
                        display: none;
                      }

                      /* Style for SVG icons in benefits - must be first child */
                      .subscription-option__benefits li > svg:first-child {
                        width: 20px;
                        height: 20px;
                        flex-shrink: 0;
                        margin-top: 2px;
                      }

                      /* Style for custom icon wrapper */
                      .subscription-option__benefits li .benefit-icon {
                        width: 20px;
                        height: 20px;
                        flex-shrink: 0;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-top: 2px;
                      }

                      /* Hide default checkmark if custom icon wrapper is present */
                      .subscription-option__benefits li:has(.benefit-icon)::before {
                        display: none;
                      }

                      /* Default checkmark icon if no custom icon */
                      {% comment %} .subscription-option__benefits li::before {
                        content: '';
                        color: #1A365D;
                        font-weight: bold;
                        flex-shrink: 0;
                        margin-top: 2px;
                        width: 20px;
                        height: 20px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        background: #F5F3FF;
                        border-radius: 50%;
                        font-size: 12px;
                      } {% endcomment %}

                      /* Hide default checkmark if custom icon/SVG is present */
                      .subscription-option__benefits li:has(svg)::before,
                      .subscription-option__benefits li:has(.benefit-icon)::before {
                        display: none;
                      }

                      /* Fallback for browsers without :has() support */
                      @supports not selector(:has(*)) {
                        .subscription-option__benefits li svg ~ *::before {
                          display: none;
                        }
                      }

                      /* Style for SVG icons in benefits */
                      .subscription-option__benefits li svg {
                        width: 20px;
                        height: 20px;
                        flex-shrink: 0;
                        margin-top: 2px;
                      }

                      /* Style for custom icon wrapper */
                      .subscription-option__benefits li .benefit-icon {
                        width: 20px;
                        height: 20px;
                        flex-shrink: 0;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-top: 2px;
                      }

                      /* Style for benefit text */
                      .subscription-option__benefits li > *:not(svg):not(.benefit-icon) {
                        flex: 1;
                      }

                      .subscription-picker__details {
                        margin-top: 16px;
                      }

                      .subscription-details {
                        border-top: 1px solid #E8E8E8;
                        padding-top: 16px;
                      }

                      .subscription-details__summary {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        cursor: pointer;
                        list-style: none;
                        font-size: 14px;
                        color: #666;
                      }

                      .subscription-details__summary::-webkit-details-marker {
                        display: none;
                      }

                      .subscription-details__icon {
                        width: 16px;
                        height: 16px;
                        flex-shrink: 0;
                      }

                      .subscription-details__content {
                        margin-top: 12px;
                        padding: 16px;
                        background: #F8F8F8;
                        border-radius: 8px;
                        font-size: 14px;
                        line-height: 1.6;
                      }

                      div[data-option-type="subscription"] {
                        border-top-left-radius: 12px;
                        border-top-right-radius: 0 !important;
                        border-bottom-left-radius: 12px;
                        border-bottom-right-radius: 12px;
                      }

                      @media (max-width: 767px) {
                        .subscription-picker__title {
                          font-size: 14px;
                        }
                        .subscription-price {
                          flex-direction: column;
                        }
                        .subscription-option {
                          padding: 12px 16px;
                        }

                        .subscription-price__original {
                          font-size: 12px;
                        }
                        .subscription-savings-badge {
                          font-size: 10px;
                        }
                        .subscription-option__expandable {
                          flex-direction: column-reverse
                        }
                        .subscription-option__label {
                          font-size: 14px;
                        }
                        .subscription-price__current {
                        font-size: 14px;}
                        .subscription-interval-select {
                          width: 100%;
                        }
                      }
                    </style>
                  {%- endif -%}

{% if block.settings.text_above_checkout != blank %}
                        <div class="lightly-spaced-row text-above-checkout">
                          {%- liquid
                            if block.settings.enable_text_box
                              assign box_color_brightness = block.settings.text_box_color | color_brightness
                              if box_color_brightness > 128
                                assign box_color_saturation = block.settings.text_box_color | color_extract: 'saturation'
                                if box_color_saturation > 0
                                  assign text_col = block.settings.text_box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                                else
                                  assign text_col = block.settings.text_box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                                endif
                              else
                                assign text_col = '255,255,255'
                              endif
                            endif
                          -%}
                          <div class="product-info-block{% if block.settings.text_icon != blank or block.settings.text_custom_icon != blank %} with-icon with-icon--right{% endif %}{% if block.settings.enable_text_box %} text-box{% endif %}" {% if block.settings.enable_text_box %}style="--box-color: {{ block.settings.text_box_color }}; --box-text-color: {{ text_col }}"{% endif %}>
                            {%- if block.settings.text_icon == blank and block.settings.text_custom_icon == blank -%}
                              <div class="rte cf">{{ block.settings.text_above_checkout }}</div>
                            {%- else -%}
                              <span class="with-icon__beside rte cf">{{ block.settings.text_above_checkout }}</span>
                              {% if block.settings.text_custom_icon == blank %}
                                {% render 'icon', icon: block.settings.text_icon, size: block.settings.text_icon_size %}
                              {% else %}
                                {%- liquid
                                  if block.settings.text_icon_size == 'large'
                                    assign icon_sizes = '38px'
                                    assign icon_widths = '38, 76'
                                  else
                                    assign icon_sizes = '16px'
                                    assign icon_widths = '16, 32'
                                  endif
                                -%}
                                <span class="icon icon--image icon--{{ block.settings.text_icon_size }}">
                                  {%- render 'image' with block.settings.text_custom_icon, sizes: icon_sizes, widths: icon_widths -%}
                                </span>
                              {% endif %}
                            {%- endif -%}
                          </div>
                        </div>
                      {% endif %}
                  <!-- Quiz Incomplete CTA (Hidden by default, shown by JS if quiz not completed) -->
                  <div class="quiz-cta-wrapper {{ block.id }}-main-quiz-button" style="display: none;">
                    <a href="{{ block.settings.quiz_cta_url | default: '/pages/get-your-formula' }}" class="btn btn--wide quiz-cta-button">
                      {{ block.settings.quiz_cta_text | default: 'Get Your Formula' }}<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="#1A365D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

                    </a>
                  </div>
                    
                  <!-- Regular Buy Buttons (Hidden by JS if quiz not completed) -->
                  <div class="quantity-submit-row input-row {% if enable_dynamic_payment_button %}has-spb{% endif %} js-regular-buy-buttons">
                    {% if block.settings.show_quantity_selector %}
                      <label class="label" for="quantity">{{ 'products.product.quantity' | t }}</label>
                      <quantity-wrapper class="buttoned-input">
                        <a href="#" data-quantity="down" aria-label="{{ 'cart.items.decrease_quantity' | t }}">{% render 'icon-minus' %}</a>
                        <input aria-label="{{ 'products.product.quantity' | t }}" id="quantity" type="number" name="quantity" value="1" />
                        <a href="#" data-quantity="up" aria-label="{{ 'cart.items.increase_quantity' | t }}">{% render 'icon-plus' %}</a>
                      </quantity-wrapper>
                    {% endif %}

                    <div class="quantity-submit-row__submit input-row">
                      <div class="js-form-error lightly-spaced-row" role="alert" hidden></div>

                      {%- capture add_to_cart_text -%}
                        {%- if product.template_suffix contains 'preorder' -%}
                          {{- 'products.product.preorder' | t -}}
                        {%- else -%}
                          {{- 'products.product.add_to_cart' | t -}}
                        {%- endif -%}
                      {%- endcapture -%}
                      <button class="btn btn--large add-to-cart" type="submit" name="add" data-add-to-cart-text="{{ add_to_cart_text | escape }}"{% if product.available == false %} disabled{% endif %}>
                        {%- if current_variant.available or current_variant == false -%}
                          {{- add_to_cart_text -}}
                        {%- else -%}
                          {{- 'products.variant.no_stock' | t -}}
                        {%- endif -%}
                      </button>
                    </div>
                    {% if enable_dynamic_payment_button %}
                      {%- comment -%} Text block above checkout button {%- endcomment -%}
                      {% if block.settings.text_above_checkout != blank %}
                        <div class="lightly-spaced-row text-above-checkout">
                          {%- liquid
                            if block.settings.enable_text_box
                              assign box_color_brightness = block.settings.text_box_color | color_brightness
                              if box_color_brightness > 128
                                assign box_color_saturation = block.settings.text_box_color | color_extract: 'saturation'
                                if box_color_saturation > 0
                                  assign text_col = block.settings.text_box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                                else
                                  assign text_col = block.settings.text_box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                                endif
                              else
                                assign text_col = '255,255,255'
                              endif
                            endif
                          -%}
                          <div class="product-info-block{% if block.settings.text_icon != blank or block.settings.text_custom_icon != blank %} with-icon with-icon--right{% endif %}{% if block.settings.enable_text_box %} text-box{% endif %}" {% if block.settings.enable_text_box %}style="--box-color: {{ block.settings.text_box_color }}; --box-text-color: {{ text_col }}"{% endif %}>
                            {%- if block.settings.text_icon == blank and block.settings.text_custom_icon == blank -%}
                              <div class="rte cf">{{ block.settings.text_above_checkout }}</div>
                            {%- else -%}
                              <span class="with-icon__beside rte cf">{{ block.settings.text_above_checkout }}</span>
                              {% if block.settings.text_custom_icon == blank %}
                                {% render 'icon', icon: block.settings.text_icon, size: block.settings.text_icon_size %}
                              {% else %}
                                {%- liquid
                                  if block.settings.text_icon_size == 'large'
                                    assign icon_sizes = '38px'
                                    assign icon_widths = '38, 76'
                                  else
                                    assign icon_sizes = '16px'
                                    assign icon_widths = '16, 32'
                                  endif
                                -%}
                                <span class="icon icon--image icon--{{ block.settings.text_icon_size }}">
                                  {%- render 'image' with block.settings.text_custom_icon, sizes: icon_sizes, widths: icon_widths -%}
                                </span>
                              {% endif %}
                            {%- endif -%}
                          </div>
                        </div>
                      {% endif %}
                      <div class="product-dynamic-payment-button">
                        <script class="dynamic-payment-button-template" type="text/template">
                          {{ form | payment_button }}
                        </script>
                      </div>
                    {% endif %}

                    {% if block.settings.show_backorder_text %}
                      {% render 'backorder', product: product, variant: current_variant %}
                    {% endif %}
                  </div>

                {% else %}
                  <div class="quantity-submit-row input-row">
                    <div class="quantity-submit-row__submit">
                      <button class="btn btn--large" name="add" type="submit" disabled>
                        {{- 'products.variant.no_stock' | t -}}
                      </button>
                    </div>
                  </div>
                {% endif %}
              {% endform %}

              {%- if product.available and block.settings.show_pickup_availability -%}
                {% render 'pickup-availability', current_variant: current_variant %}
              {%- endif -%}
            </buy-buttons>

            <script>
              // Check if quiz is completed
              (function() {
                const quizCompleted = localStorage.getItem('quiz_completed') === 'true';
                const buyButtonsBlock = document.querySelector('buy-buttons');

                // Check if product has "no consult" tag
                const productTags = {{ product.tags | json }};
                const hasNoConsultTag = productTags.some(tag =>
                  tag.toLowerCase() === 'no consult' || tag.toLowerCase() === 'no-consult'
                );

                if (buyButtonsBlock) {
                  const regularButtons = buyButtonsBlock.querySelector('.js-regular-buy-buttons');
                  const quizCTA = buyButtonsBlock.querySelector('.quiz-cta-wrapper');

                  // If product has "no consult" tag, always show regular buttons (allow direct purchase)
                  if (hasNoConsultTag) {
                    if (regularButtons) regularButtons.style.display = '';
                    if (quizCTA) quizCTA.style.display = 'none';
                  } else if (!quizCompleted) {
                    // Hide regular buy buttons, show quiz CTA
                    if (regularButtons) regularButtons.style.display = 'none';
                    if (quizCTA) {
                      quizCTA.style.setProperty('display', 'block', 'important');
                    }
                  } else {
                    // Show regular buy buttons, hide quiz CTA
                    if (regularButtons) regularButtons.style.display = '';
                    if (quizCTA) quizCTA.style.display = 'none';
                  }
                }
              })();
            </script>

            {%- if block.settings.show_usp_badges -%}
              <div class="cart-drawer__usp-badges">
                {%- if block.settings.usp_1_label != blank -%}
                  <div class="cart-drawer__usp-badge">
                    <div class="cart-drawer__usp-badge-icon">
                      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8.8125 0C3.94549 0 0 3.94549 0 8.8125C0 13.6795 3.94549 17.625 8.8125 17.625C13.6795 17.625 17.625 13.6795 17.625 8.8125C17.625 3.94549 13.6795 0 8.8125 0Z" fill="#CCCCE8"/>
                      <path d="M12.1456 6.49463L7.22911 11.4111L4.99435 9.17634" stroke="#1A365D" stroke-width="1.45455" stroke-linecap="square" stroke-linejoin="round"/>
                      </svg>

                    </div>
                    <span class="cart-drawer__usp-badge-label">{{ block.settings.usp_1_label }}</span>
                  </div>
                {%- endif -%}
                {%- if block.settings.usp_2_label != blank -%}
                  <div class="cart-drawer__usp-badge">
                    <div class="cart-drawer__usp-badge-icon">
                      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8.8125 0C3.94549 0 0 3.94549 0 8.8125C0 13.6795 3.94549 17.625 8.8125 17.625C13.6795 17.625 17.625 13.6795 17.625 8.8125C17.625 3.94549 13.6795 0 8.8125 0Z" fill="#CCCCE8"/>
                      <path d="M12.1456 6.49463L7.22911 11.4111L4.99435 9.17634" stroke="#1A365D" stroke-width="1.45455" stroke-linecap="square" stroke-linejoin="round"/>
                      </svg>

                    </div>
                    <span class="cart-drawer__usp-badge-label">{{ block.settings.usp_2_label }}</span>
                  </div>
                {%- endif -%}
                {%- if block.settings.usp_3_label != blank -%}
                  <div class="cart-drawer__usp-badge">
                    <div class="cart-drawer__usp-badge-icon">
                      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8.8125 0C3.94549 0 0 3.94549 0 8.8125C0 13.6795 3.94549 17.625 8.8125 17.625C13.6795 17.625 17.625 13.6795 17.625 8.8125C17.625 3.94549 13.6795 0 8.8125 0Z" fill="#CCCCE8"/>
                      <path d="M12.1456 6.49463L7.22911 11.4111L4.99435 9.17634" stroke="#1A365D" stroke-width="1.45455" stroke-linecap="square" stroke-linejoin="round"/>
                      </svg>

                    </div>
                    <span class="cart-drawer__usp-badge-label">{{ block.settings.usp_3_label }}</span>
                  </div>
                {%- endif -%}
              </div>
            {%- endif -%}

            <div class="section-footer__payment-icons">
              {% for type in shop.enabled_payment_types %}
                {{ type | payment_type_svg_tag: class: 'section-footer__payment-icon' }}
              {% endfor %}
            </div>

          {% when 'inventory-level' %}
            <div {% unless block.settings.show_in_quickbuy %}class="not-in-quickbuy"{% endunless %} {{ block.shopify_attributes }}>
              {%- render 'product-inventory', product: product, current_variant: current_variant, block: block -%}
            </div>

          {% when 'accordion' %}
            {%- liquid
              assign content = block.settings.content
              if block.settings.page != blank
                assign content = pages[block.settings.page].content
              endif
              assign content = content | append: block.settings.custom_liquid
            -%}
            {%- if content != blank -%}
              <div class="product-info-accordion{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                <details-disclosure>
                  <details class="disclosure"{% if block.settings.open %} open{% endif %}>
                    <summary class="disclosure__title">
                      {%- if block.settings.icon == blank -%}
                        {{- block.settings.title | escape -}}
                      {%- else -%}
                        <div class="with-icon">
                          {% render 'icon', icon: block.settings.icon, size: 'small' %}
                          <span class="with-icon__beside">{{ block.settings.title | escape }}</span>
                        </div>
                      {%- endif -%}
                    </summary>
                    <div class="disclosure__panel has-motion">
                      <div class="disclosure__content rte cf">
                        {{- content -}}
                      </div>
                    </div>
                  </details>
                </details-disclosure>
              </div>
            {%- endif -%}

          {% when 'text' %}
            {% if block.settings.text != blank %}
              <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                {%- liquid
                  if block.settings.enable_box
                    assign box_color_brightness = block.settings.box_color | color_brightness
                    if box_color_brightness > 128
                      assign box_color_saturation = block.settings.box_color | color_extract: 'saturation'
                      if box_color_saturation > 0
                        assign text_col = block.settings.box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                      else
                        assign text_col = block.settings.box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                      endif
                    else
                      assign text_col = '255,255,255'
                    endif
                  endif
                -%}
                <div class="product-info-block{% if block.settings.icon != blank or block.settings.custom_icon != blank %} with-icon{% endif %}{% if block.settings.enable_box %} text-box{% endif %}" {% if block.settings.enable_box %}style="--box-color: {{ block.settings.box_color }}; --box-text-color: {{ text_col }}"{% endif %}>
                  {%- if block.settings.icon == blank and block.settings.custom_icon == blank -%}
                    {{- block.settings.text -}}
                  {%- else -%}
                    {% if block.settings.custom_icon == blank %}
                      {% render 'icon', icon: block.settings.icon, size: block.settings.icon_size %}
                    {% else %}
                      {%- liquid
                        if block.settings.icon_size == 'large'
                          assign icon_sizes = '38px'
                          assign icon_widths = '38, 76'
                        else
                          assign icon_sizes = '16px'
                          assign icon_widths = '16, 32'
                        endif
                      -%}
                      <span class="icon icon--image icon--{{ block.settings.icon_size }}">
                        {%- render 'image' with block.settings.custom_icon, sizes: icon_sizes, widths: icon_widths -%}
                      </span>
                    {% endif %}
                    <span class="with-icon__beside">{{ block.settings.text }}</span>
                  {%- endif -%}
                </div>
              </div>
            {% endif %}

          {% when 'richtext' %}
            {% if block.settings.richtext != blank %}
              <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                {%- liquid
                  if block.settings.enable_box
                    assign box_color_brightness = block.settings.box_color | color_brightness
                    if box_color_brightness > 128
                      assign box_color_saturation = block.settings.box_color | color_extract: 'saturation'
                      if box_color_saturation > 0
                        assign text_col = block.settings.box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                      else
                        assign text_col = block.settings.box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                      endif
                    else
                      assign text_col = '255,255,255'
                    endif
                  endif
                  
                  assign desktop_bg = block.settings.desktop_background_color | default: '#ffffff'
                  assign desktop_br = block.settings.desktop_border_radius | default: 0
                  assign desktop_pad = block.settings.desktop_padding | default: 0
                  assign mobile_bg = block.settings.mobile_background_color | default: '#ffffff'
                  assign mobile_br = block.settings.mobile_border_radius | default: 0
                  assign mobile_pad = block.settings.mobile_padding | default: 0
                -%}
                <div class="richtext product-info-block {% if block.settings.icon != blank or block.settings.custom_icon != blank %} with-icon{% endif %}{% if block.settings.enable_box %} text-box{% endif %}" 
                     style="
                       {% if block.settings.enable_box %}--box-color: {{ block.settings.box_color }}; --box-text-color: {{ text_col }};{% endif %}
                       --desktop-bg: {{ desktop_bg }};
                       --desktop-br: {{ desktop_br }}px;
                       --desktop-pad: {{ desktop_pad }}px;
                       --mobile-bg: {{ mobile_bg }};
                       --mobile-br: {{ mobile_br }}px;
                       --mobile-pad: {{ mobile_pad }}px;
                       background-color: var(--mobile-bg);
                       border-radius: var(--mobile-br);
                       padding: var(--mobile-pad);
                     "
                     data-block-id="{{ block.id }}">
                  {%- if block.settings.icon == blank and block.settings.custom_icon == blank -%}
                    <div class="rte cf">{{ block.settings.richtext }}</div>
                  {%- else -%}
                    {% if block.settings.custom_icon == blank %}
                      {% render 'icon', icon: block.settings.icon, size: block.settings.icon_size %}
                    {% else %}
                      {%- liquid
                        if block.settings.icon_size == 'large'
                          assign icon_sizes = '38px'
                          assign icon_widths = '38, 76'
                        else
                          assign icon_sizes = '16px'
                          assign icon_widths = '16, 32'
                        endif
                      -%}
                      <span class="icon icon--image icon--{{ block.settings.icon_size }}">
                        {%- render 'image' with block.settings.custom_icon, sizes: icon_sizes, widths: icon_widths -%}
                      </span>
                    {% endif %}
                    <div class="with-icon__beside rte cf">{{ block.settings.richtext }}</div>
                  {%- endif -%}
                </div>
              </div>
            {% endif %}

          {% when 'pop-up' %}
            {% if block.settings.page != blank %}
              <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                <modal-opener class="no-js-hidden" data-modal="modal-{{ block.id }}">
                  <button type="button" class="{% if block.settings.style != 'link' %}btn btn--{{ block.settings.style }}{% else %}small-feature-link{% endif %}" aria-haspopup="dialog">
                    {{- block.settings.text | escape -}}
                  </button>
                </modal-opener>
                <a href="{{ block.settings.page.url }}" class="link js-hidden">{{ block.settings.text | escape }}</a>
              </div>
            {% endif %}

          {% when 'link' %}
            {% if block.settings.text != blank %}
              <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                <a class="{% if block.settings.style != 'link' %}btn btn--{{ block.settings.style }}{% else %}small-feature-link{% endif %}" href="{{ block.settings.url }}"{% if block.settings.open_in_new_tab %} target="_blank"{% endif %}>{{ block.settings.text | escape }}</a>
              </div>
            {% endif %}

          {% when 'image' %}
            {% if block.settings.image != blank %}
              <div class="lightly-spaced-row inline-width-container{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" style="width: {{ block.settings.image_width }}px" {{ block.shopify_attributes }}>
                {% if block.settings.url != blank %}<a href="{{ block.settings.url }}"{% if block.settings.open_in_new_tab %} target="_blank"{% endif %}>{% endif %}
                  {%- assign image_max_width = block.settings.image_width | at_most: 490 -%}
                  {%- capture image_widths -%}(min-width: {{ image_max_width }}px) {{ image_max_width }}px, 100vw{%- endcapture -%}
                  {%- liquid
                    assign image_widths = '320, 480, 580, 640, 700' | append: image_max_width | append: ', '
                    assign image_widths = image_max_width | times: 2 | append: 'px' | prepend: image_widths
                    render 'image' with block.settings.image, sizes: image_widths, widths: image_widths
                  -%}
                {% if block.settings.url != blank %}</a>{% endif %}
              </div>
            {% endif %}

          {% when 'icon-columns' %}
            {% if block.settings.icon_1 != blank or block.settings.custom_icon_1 != blank or block.settings.icon_2 != blank or block.settings.custom_icon_2 != blank or block.settings.icon_3 != blank or block.settings.custom_icon_3 != blank %}
              {%- liquid
                if block.settings.enable_box
                  assign box_color_brightness = block.settings.box_color | color_brightness
                  if box_color_brightness > 128
                    assign box_color_saturation = block.settings.box_color | color_extract: 'saturation'
                    if box_color_saturation > 0
                      assign text_col = block.settings.box_color | color_darken: 60 | color_saturate: 30 | color_to_rgb | split: '(' | last | split: ')' | first
                    else
                      assign text_col = block.settings.box_color | color_darken: 60 | color_to_rgb | split: '(' | last | split: ')' | first
                    endif
                  else
                    assign text_col = '255,255,255'
                  endif
                endif

                assign icon_count = 0
                if block.settings.icon_1 != blank or block.settings.custom_icon_1 != blank
                  assign icon_count = icon_count | plus: 1
                endif
                if block.settings.icon_2 != blank or block.settings.custom_icon_2 != blank
                  assign icon_count = icon_count | plus: 1
                endif
                if block.settings.icon_3 != blank or block.settings.custom_icon_3 != blank
                  assign icon_count = icon_count | plus: 1
                endif
              -%}
              <div class="{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}{% if block.settings.enable_box %} my-gutter text-box text-box--wide{% else %} my-7{% endif %}"{% if block.settings.enable_box %} style="--box-color: {{ block.settings.box_color }}; --box-text-color: {{ text_col }}"{% endif %} {{ block.shopify_attributes }}>
                <div class="flex gap-gutter align-center
                            {%- if block.settings.enable_box %} my-2 px-2{% endif %}
                            {%- if icon_count == 2 %} mx-5{% endif %}
                            {%- if block.settings.text_size == 'sm' %} text-sm{% endif %}">
                  {% if block.settings.icon_1 != blank or block.settings.custom_icon_1 != blank %}
                    <div class="flex-1">
                      {% if block.settings.custom_icon_1 == blank %}
                        <span{% if block.settings.icon_1_color.alpha > 0 %} style="color: {{ block.settings.icon_1_color }}"{% endif %}>
                          {%- render 'icon', icon: block.settings.icon_1, size: block.settings.icon_size -%}
                        </span>
                      {% else %}
                        {%- liquid
                          if block.settings.icon_size == 'extra-large'
                            assign icon_sizes = '52px'
                            assign icon_widths = '52, 104'
                          elsif block.settings.icon_size == 'large'
                            assign icon_sizes = '38px'
                            assign icon_widths = '38, 76'
                          else
                            assign icon_sizes = '24px'
                            assign icon_widths = '24, 48'
                          endif
                        -%}
                        <div class="icon icon--image icon--{{ block.settings.icon_size }} mx-auto">
                          {%- render 'image' with block.settings.custom_icon_1, sizes: icon_sizes, widths: icon_widths -%}
                        </div>
                      {% endif %}
                      {% if block.settings.icon_1_heading != blank %}
                        <div class="mt-2"><strong role="heading" aria-level="2">{{ block.settings.icon_1_heading }}</strong></div>
                      {% endif %}
                      {% if block.settings.icon_1_text != blank %}
                        <div class="{% if block.settings.icon_1_heading == blank %}mt-2{% endif %}">{{ block.settings.icon_1_text }}</div>
                      {% endif %}
                    </div>
                  {% endif %}
                  {% if block.settings.icon_2 != blank or block.settings.custom_icon_2 != blank %}
                    <div class="flex-1">
                      {% if block.settings.custom_icon_2 == blank %}
                        <span{% if block.settings.icon_2_color.alpha > 0 %} style="color: {{ block.settings.icon_2_color }}"{% endif %}>
                          {%- render 'icon', icon: block.settings.icon_2, size: block.settings.icon_size -%}
                        </span>
                      {% else %}
                        {%- liquid
                          if block.settings.icon_size == 'extra-large'
                            assign icon_sizes = '52px'
                            assign icon_widths = '52, 104'
                          elsif block.settings.icon_size == 'large'
                            assign icon_sizes = '38px'
                            assign icon_widths = '38, 76'
                          else
                            assign icon_sizes = '24px'
                            assign icon_widths = '24, 48'
                          endif
                        -%}
                        <div class="icon icon--image icon--{{ block.settings.icon_size }} mx-auto">
                          {%- render 'image' with block.settings.custom_icon_2, sizes: icon_sizes, widths: icon_widths -%}
                        </div>
                      {% endif %}
                      {% if block.settings.icon_2_heading != blank %}
                        <div class="mt-2"><strong role="heading" aria-level="2">{{ block.settings.icon_2_heading }}</strong></div>
                      {% endif %}
                      {% if block.settings.icon_2_text != blank %}
                        <div class="{% if block.settings.icon_2_heading == blank %}mt-2{% endif %}">{{ block.settings.icon_2_text }}</div>
                      {% endif %}
                    </div>
                  {% endif %}
                  {% if block.settings.icon_3 != blank or block.settings.custom_icon_3 != blank %}
                    <div class="flex-1">
                      {% if block.settings.custom_icon_3 == blank %}
                        <span{% if block.settings.icon_3_color.alpha > 0 %} style="color: {{ block.settings.icon_3_color }}"{% endif %}>
                          {%- render 'icon', icon: block.settings.icon_3, size: block.settings.icon_size -%}
                        </span>
                      {% else %}
                        {%- liquid
                          if block.settings.icon_size == 'extra-large'
                            assign icon_sizes = '52px'
                            assign icon_widths = '52, 104'
                          elsif block.settings.icon_size == 'large'
                            assign icon_sizes = '38px'
                            assign icon_widths = '38, 76'
                          else
                            assign icon_sizes = '24px'
                            assign icon_widths = '24, 48'
                          endif
                        -%}
                        <div class="icon icon--image icon--{{ block.settings.icon_size }} mx-auto">
                          {%- render 'image' with block.settings.custom_icon_3, sizes: icon_sizes, widths: icon_widths -%}
                        </div>
                      {% endif %}
                      {% if block.settings.icon_3_heading != blank %}
                        <div class="mt-2"><strong role="heading" aria-level="2">{{ block.settings.icon_3_heading }}</strong></div>
                      {% endif %}
                      {% if block.settings.icon_3_text != blank %}
                        <div class="{% if block.settings.icon_3_heading == blank %}mt-2{% endif %}">{{ block.settings.icon_3_text }}</div>
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
              </div>
            {% endif %}

          {% when 'custom-liquid' %}
            {% if block.settings.custom_liquid != blank %}
              <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>{{ block.settings.custom_liquid }}</div>
            {% endif %}

          {% when 'sharing' %}
            <div class="input-row not-in-quickbuy" {{ block.shopify_attributes }}>
              <div class="social-share flex items-center">
                <p class="social-share__heading">{{ 'general.social.share_heading' | t }}</p>
                {% render 'social-share',
                    share_twitter: block.settings.show_twitter,
                    share_facebook: block.settings.show_facebook,
                    share_pinterest: block.settings.show_pinterest,
                    share_title: product.title,
                    share_url: product.url,
                    share_image: product %}
              </div>
            </div>

          {% when 'divider' %}
            <hr {% unless block.settings.show_in_quickbuy %}class="not-in-quickbuy"{% endunless %} {{ block.shopify_attributes }}>

          {% when 'custom-option' %}
            {%- if block.settings.label != blank -%}
              {%- liquid
                assign custom_option_input_id = product_form_id | append: '-custom-' | append: forloop.index
                assign custom_input_name = block.settings.label | escape | prepend: 'properties[' | append: ']'
              -%}
              <div class="custom-option" {{ block.shopify_attributes }}>
                {% case block.settings.type %}
                  {% when 'text' %}
                    <div class="option-selector option-selector--custom">
                      <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
                      <input class="custom-option__text-input" type="text" id="{{ custom_option_input_id }}" form="{{ product_form_id }}" name="{{ custom_input_name }}" {% if block.settings.text_required %}required{% endif %}>
                    </div>

                  {% when 'textarea' %}
                    <div class="option-selector option-selector--custom">
                      <label class="label" for="{{ custom_option_input_id }}">{{ block.settings.label | escape }}</label>
                      <textarea class="custom-option__text-input" id="{{ custom_option_input_id }}" form="{{ product_form_id }}" name="{{ custom_input_name }}" {% if block.settings.text_required %}required{% endif %}></textarea>
                    </div>

                  {% when 'checkbox' %}
                    <div class="option-selector option-selector--custom">
                      <label class="label">
                        <input type="hidden" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ block.settings.checkbox_unchecked_value | escape }}">
                        <input type="checkbox" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ block.settings.checkbox_checked_value | escape }}">
                        <span class="label__text-beside-input">{{ block.settings.label | escape }}</span>
                      </label>
                    </div>

                  {% when 'multiple' %}
                    {%- assign custom_options = block.settings.multiple_options | newline_to_br | strip_newlines | split: '<br />' -%}

                    {% if block.settings.multiple_style == 'dropdown' %}
                      <div class="option-selector option-selector--custom" data-selector-type="dropdown">
                        <script src="{{ 'custom-select.js' | asset_url }}" defer></script>
                        {% render 'custom-select',
                          id: custom_option_input_id,
                          label: block.settings.label,
                          option_values: custom_options,
                          selected_value: custom_options.first,
                          include_native: true,
                          native_name: custom_input_name,
                          native_form_id: product_form_id
                        %}
                      </div>

                    {% else %}
                      <div class="option-selector option-selector--custom" data-selector-type="radio">
                        <fieldset>
                          <legend class="label">{{ block.settings.label | escape }}</legend>
                          {% for option in custom_options %}
                            <label class="label">
                              <input type="radio" form="{{ product_form_id }}" name="{{ custom_input_name }}" value="{{ option | escape }}"{% if forloop.first %} checked{% endif %}>
                              <span class="label__text-beside-input">{{ option | escape }}</span>
                            </label>
                          {% endfor %}
                        </fieldset>
                      </div>
                    {% endif %}

                {% endcase %}
              </div>
            {%- endif -%}

          {% when 'related-products' %}
            {% if block.settings.product_list != blank %}
              <div class="{% if block.settings.style == 'card' %}lightly-spaced-row lightish-spaced-row-above{% else %}input-row{% endif %}{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                <div class="label" role="heading" aria-level="2">{{ block.settings.title | escape }}</div>
                {%- liquid
                  if settings.prod_thumb_shape == 'portrait-23'
                    assign chosen_aspect_ratio = 0.67
                  elsif settings.prod_thumb_shape == 'portrait-45'
                    assign chosen_aspect_ratio = 0.8
                  elsif settings.prod_thumb_shape == 'square'
                    assign chosen_aspect_ratio = 1.0
                  elsif settings.prod_thumb_shape == 'landscape-54'
                    assign chosen_aspect_ratio = 1.25
                  elsif settings.prod_thumb_shape == 'landscape-32'
                    assign chosen_aspect_ratio = 1.50
                  elsif settings.prod_thumb_shape == 'tallest'
                    assign chosen_aspect_ratio = 99
                    for related_product in block.settings.product_list
                      if related_product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                        assign chosen_aspect_ratio = related_product.featured_media.preview_image.aspect_ratio
                      endif
                    endfor
                  else
                    assign chosen_aspect_ratio = 0
                    for related_product in block.settings.product_list
                      if related_product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                        assign chosen_aspect_ratio = related_product.featured_media.preview_image.aspect_ratio
                      endif
                    endfor
                  endif

                  if settings.prod_thumb_crop
                    assign custom_crop = settings.prod_thumb_crop_align
                  else
                    assign custom_crop = 'contain'
                  endif
                -%}
                {%- if block.settings.style == 'card' -%}
                  <div class="fixed-layout">
                    {%- for related_product in block.settings.product_list -%}
                      <div class="column column--half">
                        {%- render 'product-block', product: related_product, no_quick_buy: true, custom_aspect_ratio: chosen_aspect_ratio, grid: 5 -%}
                      </div>
                    {%- endfor -%}
                  </div>
                {%- else -%}
                  <div class="related-swatches" style="--image-width: {{ block.settings.image_width }}px">
                    {%- capture widths -%}{{ block.settings.image_width }}, {{ block.settings.image_width | times: 2 }}{%- endcapture -%}
                    {%- for related_product in block.settings.product_list -%}
                      <a class="related-swatch img-var
                          {%- if related_product.id == product.id %} related-swatch--active{% endif %}
                          {%- unless related_product.available %} related-swatch--unavailable{% endunless %}"
                         href="{% if collection and related_product.collections contains collection %}{{ related_product.url | within: collection }}{% else %}{{ related_product.url }}{% endif %}"
                         title="{{ related_product.title | escape }}">
                        {%- render 'image',
                          image: related_product.featured_media.preview_image,
                          sizes: block.settings.image_width,
                          widths: widths,
                          custom_aspect_ratio: chosen_aspect_ratio,
                          custom_crop: custom_crop
                        -%}
                        <span class="visually-hidden">{{ related_product.title }}</span>
                      </a>
                    {%- endfor -%}
                  </div>
                {%- endif -%}
              </div>
            {% endif %}

          {% when 'product-upsells' %}
            {%- if block.settings.product_list != blank -%}
              <div class="lightly-spaced-row lightish-spaced-row-above{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
                <div class="product-item-upsells" data-block-id="{{ block.id }}">
                  <cc-product-upsell data-from="{{ routes.product_recommendations_url }}?section_id=mini-related-products&limit=8&product_id={{ product.id }}">
                    <carousel-slider class="carousel block collection-slider use-color-scheme use-color-scheme--{{ block.settings.color_scheme }}" data-dispatch-events="false">
                      <div class="opposing-items opposing-items--valign-base very-lightly-spaced-row">
                        <div class="opposing-items__left product-info-label">
                          <h2>{{ block.settings.title | escape }}</h2>
                          {% if block.settings.subtitle != blank %}
                            <p>{{ block.settings.subtitle }}</p>
                          {% endif %}
                        </div>
                        <div class="no-wrap slider-nav">
                          <button name="prev" class="slider-nav__btn has-ltr-icon">
                            <span class="visually-hidden">{{ 'general.slider.previous' | t }}</span>
                           <svg width="5" height="9" viewBox="0 0 7 11" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 1L1 5.5L6 10" stroke="#192F06" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

                          </button>
                          <button name="next" class="slider-nav__btn has-ltr-icon">
                            <span class="visually-hidden">{{ 'general.slider.next' | t }}</span>
                          <svg width="5" height="9" viewBox="0 0 7 11" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1 1L6 5.5L1 10" stroke="#192F06" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

                          </button>
                        </div>
                      </div>
                      <div class="slider slider--no-scrollbar slider--edge-peek">
                        <ul class="slider__grid product-grid product-grid--carousel product-grid--per-row-2 product-grid--per-row-mob-2">
                          {%- liquid
                            if settings.prod_thumb_shape == 'portrait-23'
                              assign chosen_aspect_ratio = 0.67
                            elsif settings.prod_thumb_shape == 'portrait-45'
                              assign chosen_aspect_ratio = 0.8
                            elsif settings.prod_thumb_shape == 'square'
                              assign chosen_aspect_ratio = 1.0
                            elsif settings.prod_thumb_shape == 'landscape-54'
                              assign chosen_aspect_ratio = 1.25
                            elsif settings.prod_thumb_shape == 'landscape-32'
                              assign chosen_aspect_ratio = 1.50
                            elsif settings.prod_thumb_shape == 'tallest'
                              assign chosen_aspect_ratio = 99
                              for upsell_product in block.settings.product_list
                                if upsell_product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                                  assign chosen_aspect_ratio = upsell_product.featured_media.preview_image.aspect_ratio
                                endif
                              endfor
                            else
                              assign chosen_aspect_ratio = 0
                              for upsell_product in block.settings.product_list
                                if upsell_product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                                  assign chosen_aspect_ratio = upsell_product.featured_media.preview_image.aspect_ratio
                                endif
                              endfor
                            endif
                          -%}
                          {%- for upsell_product in block.settings.product_list -%}
                            <li class="slider__item">
                              {%- render 'product-upsell-product', product: upsell_product, custom_aspect_ratio: chosen_aspect_ratio -%}
                            </li>
                          {%- endfor -%}
                        </ul>
                      </div>
                      <div class="product-item-upsells__dots"></div>
                    </carousel-slider>
                  </cc-product-upsell>
                </div>
              </div>

              <script>
                (function() {
                  const blockId = '{{ block.id }}';
                  let isInitialized = false;
                  let cleanupFn = null;

                  function initProductUpsellsDots() {
                    if (isInitialized) return;

                    const upsellsContainer = document.querySelector(`.product-item-upsells[data-block-id="${blockId}"]`);
                    if (!upsellsContainer) return;

                    const carousel = upsellsContainer.querySelector('carousel-slider');
                    if (!carousel || !carousel.hasAttribute('loaded')) {
                      setTimeout(initProductUpsellsDots, 100);
                      return;
                    }

                    if (carousel.dataset.dotsInitialized === 'true') return;

                    const dotsContainer = upsellsContainer.querySelector('.product-item-upsells__dots');
                    if (!dotsContainer) return;

                    const slider = carousel.querySelector('.slider');
                    const slides = carousel.querySelectorAll('.slider__item:not([hidden])');
                    
                    if (slides.length < 2) {
                      dotsContainer.style.display = 'none';
                      return;
                    }

                    dotsContainer.style.display = 'flex';
                    carousel.dataset.dotsInitialized = 'true';

                    function getCarouselInfo() {
                      const grid = carousel.querySelector('.slider__grid');
                      if (!grid) return null;

                      const gridWidth = grid.clientWidth;
                      if (gridWidth === 0) return null;

                      const firstSlide = slides[0];
                      const secondSlide = slides[1];
                      if (!firstSlide || !secondSlide) return null;

                      const firstRect = firstSlide.getBoundingClientRect();
                      const secondRect = secondSlide.getBoundingClientRect();
                      const slideSpan = secondRect.left - firstRect.left;
                      
                      if (slideSpan <= 0) return null;

                      const isMobile = window.innerWidth < 768;
                      
                      let slidesPerPage;
                      let totalPages;
                      
                      if (isMobile) {
                        // Mobile: 1.5 slides visible
                        slidesPerPage = (gridWidth + (slideSpan - firstSlide.clientWidth)) / slideSpan;
                        totalPages = Math.max(1, slides.length);
                      } else {
                        // Desktop: 2 slides per page (2 full products)
                        slidesPerPage = 2;
                        if (slides.length <= 2) {
                          totalPages = 1;
                        } else {
                          totalPages = Math.ceil(slides.length / 2);
                        }
                      }

                      return { slidesPerPage, totalPages, slideSpan, isMobile };
                    }

                    let carouselInfo = getCarouselInfo();
                    if (!carouselInfo) {
                      setTimeout(() => {
                        carouselInfo = getCarouselInfo();
                        if (carouselInfo) initDots();
                      }, 200);
                      return;
                    }

                    let { slidesPerPage, totalPages, slideSpan, isMobile } = carouselInfo;
                    let currentPage = 0;

                    function debounce(func, wait) {
                      let timeout;
                      return function executedFunction(...args) {
                        const later = () => {
                          clearTimeout(timeout);
                          func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                      };
                    }

                    function createDots() {
                      dotsContainer.innerHTML = '';
                      if (totalPages <= 1) {
                        dotsContainer.style.display = 'none';
                        return;
                      }
                      dotsContainer.style.display = 'flex';
                      
                      for (let i = 0; i < totalPages; i++) {
                        const dot = document.createElement('button');
                        dot.className = 'product-item-upsells__dot';
                        if (i === 0) dot.classList.add('active');
                        dot.setAttribute('aria-label', `Go to page ${i + 1}`);
                        dot.dataset.pageIndex = i;
                        dot.addEventListener('click', (e) => {
                          const pageIndex = parseInt(e.currentTarget.dataset.pageIndex);
                          goToPage(pageIndex);
                        });
                        dotsContainer.appendChild(dot);
                      }
                    }

                    function goToPage(pageIndex) {
                      if (pageIndex < 0 || pageIndex >= totalPages) return;
                      
                      let targetSlideIndex;
                      if (isMobile) {
                        targetSlideIndex = Math.min(pageIndex, slides.length - 1);
                      } else {
                        // Desktop: 2 slides per page
                        targetSlideIndex = pageIndex * 2;
                        targetSlideIndex = Math.min(targetSlideIndex, slides.length - 1);
                      }
                      
                      const targetSlide = slides[targetSlideIndex];
                      if (!targetSlide) return;

                      if (typeof carousel.scrollToElement === 'function') {
                        carousel.scrollToElement(targetSlide, 'smooth');
                      } else {
                        const targetScroll = targetSlide.offsetLeft;
                        slider.scrollTo({
                          left: targetScroll,
                          behavior: 'smooth'
                        });
                      }
                      
                      setTimeout(() => {
                        const currentIndex = Math.round(Math.abs(slider.scrollLeft) / slideSpan) || 0;
                        updateDotsFromIndex(currentIndex);
                      }, 150);
                    }

                    function updateDotsFromIndex(slideIndex) {
                      let newPage;
                      if (isMobile) {
                        newPage = Math.min(slideIndex, totalPages - 1);
                      } else {
                        // Desktop: 2 slides per page
                        const maxScrollLeft = slider.scrollWidth - slider.clientWidth;
                        const isAtEnd = Math.abs(slider.scrollLeft - maxScrollLeft) < 10;
                        
                        const lastPageStartIndex = (totalPages - 1) * 2;
                        
                        if (isAtEnd || slideIndex >= lastPageStartIndex || slideIndex >= slides.length - 2) {
                          newPage = totalPages - 1;
                        } else {
                          newPage = Math.floor(slideIndex / 2);
                          newPage = Math.min(newPage, totalPages - 1);
                        }
                      }
                      
                      if (newPage >= 0 && newPage < totalPages) {
                        currentPage = newPage;
                        const dots = dotsContainer.querySelectorAll('.product-item-upsells__dot');
                        dots.forEach((dot, idx) => {
                          dot.classList.toggle('active', idx === currentPage);
                        });
                      }
                    }

                    const selectHandler = (e) => {
                      const slideIndex = e.detail.index;
                      updateDotsFromIndex(slideIndex);
                    };
                    
                    carousel.addEventListener('on:carousel-slider:select', selectHandler);
                    
                    const scrollHandler = debounce(() => {
                      const currentIndex = Math.round(Math.abs(slider.scrollLeft) / slideSpan) || 0;
                      const maxScrollLeft = slider.scrollWidth - slider.clientWidth;
                      const isAtEnd = Math.abs(slider.scrollLeft - maxScrollLeft) < 10;
                      
                      const slideIndexToUse = isAtEnd ? Math.max(currentIndex, slides.length - 1) : currentIndex;
                      updateDotsFromIndex(slideIndexToUse);
                    }, 150);
                    
                    slider.addEventListener('scroll', scrollHandler);

                    function initDots() {
                      carouselInfo = getCarouselInfo();
                      if (!carouselInfo) return;
                      
                      slidesPerPage = carouselInfo.slidesPerPage;
                      totalPages = carouselInfo.totalPages;
                      slideSpan = carouselInfo.slideSpan;
                      isMobile = carouselInfo.isMobile;
                      
                      createDots();
                      
                      const currentIndex = Math.round(Math.abs(slider.scrollLeft) / slideSpan) || 0;
                      updateDotsFromIndex(currentIndex);
                    }

                    let resizeTimeout;
                    const resizeHandler = () => {
                      clearTimeout(resizeTimeout);
                      resizeTimeout = setTimeout(() => {
                        carouselInfo = getCarouselInfo();
                        if (carouselInfo) {
                          slidesPerPage = carouselInfo.slidesPerPage;
                          totalPages = carouselInfo.totalPages;
                          slideSpan = carouselInfo.slideSpan;
                          isMobile = carouselInfo.isMobile;
                          createDots();
                          const currentIndex = Math.round(Math.abs(slider.scrollLeft) / slideSpan) || 0;
                          updateDotsFromIndex(currentIndex);
                        }
                      }, 250);
                    };
                    
                    window.addEventListener('resize', resizeHandler);

                    initDots();
                    isInitialized = true;

                    cleanupFn = () => {
                      carousel.removeEventListener('on:carousel-slider:select', selectHandler);
                      slider.removeEventListener('scroll', scrollHandler);
                      window.removeEventListener('resize', resizeHandler);
                      carousel.dataset.dotsInitialized = 'false';
                      isInitialized = false;
                    };
                  }

                  function startInit() {
                    setTimeout(() => {
                      if (!isInitialized) {
                        initProductUpsellsDots();
                      }
                    }, 300);
                  }

                  if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', startInit);
                  } else {
                    startInit();
                  }
                })();
              </script>
            {%- endif -%}

          {% when 'complementary' %}
            <cc-fetched-content class="not-in-quickbuy" data-id="{{ block.id }}" data-url="{{ routes.product_recommendations_url }}?section_id={{ section.id }}&product_id={{ product.id }}&intent=complementary" contains-product-blocks {{ block.shopify_attributes }}>
              {%- if recommendations.performed and recommendations.products_count > 0 -%}
                {%- liquid
                  if settings.prod_thumb_shape == 'portrait-23'
                    assign chosen_aspect_ratio = 0.67
                  elsif settings.prod_thumb_shape == 'portrait-45'
                    assign chosen_aspect_ratio = 0.8
                  elsif settings.prod_thumb_shape == 'square'
                    assign chosen_aspect_ratio = 1.0
                  elsif settings.prod_thumb_shape == 'landscape-54'
                    assign chosen_aspect_ratio = 1.25
                  elsif settings.prod_thumb_shape == 'landscape-32'
                    assign chosen_aspect_ratio = 1.50
                  elsif settings.prod_thumb_shape == 'tallest'
                    assign chosen_aspect_ratio = 99
                    for product in recommendations.products limit: block.settings.max_products
                      if product.featured_media.preview_image.aspect_ratio < chosen_aspect_ratio
                        assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                      endif
                    endfor
                  else
                    assign chosen_aspect_ratio = 0
                    for product in recommendations.products limit: block.settings.max_products
                      if product.featured_media.preview_image.aspect_ratio > chosen_aspect_ratio
                        assign chosen_aspect_ratio = product.featured_media.preview_image.aspect_ratio
                      endif
                    endfor
                  endif
                -%}

                <div class="lightly-spaced-row lightish-spaced-row-above not-in-quickbuy">
                  {% if block.settings.enable_carousel and recommendations.products_count > 2 and block.settings.max_products > 2 %}
                    <carousel-slider class="carousel block collection-slider">
                      <div class="opposing-items opposing-items--valign-base very-lightly-spaced-row">
                        <div class="opposing-items__left label">{{ block.settings.heading | escape }}</div>
                        <div class="no-wrap slider-nav">
                          <button name="prev" class="slider-nav__btn has-ltr-icon text-current">
                            <span class="visually-hidden">{{ 'general.slider.previous' | t }}</span>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10 12L6 8L10 4" stroke="#232323" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>

                          </button>
                          <button name="next" class="slider-nav__btn has-ltr-icon text-current">
                            <span class="visually-hidden">{{ 'general.slider.next' | t }}</span>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 12L10 8L6 4" stroke="#232323" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

                          </button>
                        </div>
                      </div>
                      <div class="collection-listing slider slider--no-scrollbar">
                        <div class="product-grid product-grid--per-row-2 product-grid--per-row-mob-2 slider__grid product-grid--carousel">
                          {% for related_product in recommendations.products limit: block.settings.max_products %}
                            <div class="slider__item{% if forloop.first %} is-active{% endif %}">
                              {%- render 'product-block', product: related_product, no_quick_buy: true, no_swiping: true, custom_aspect_ratio: chosen_aspect_ratio, grid: 5 -%}
                            </div>
                          {% endfor %}
                        </div>
                      </div>
                    </carousel-slider>
                  {% else %}
                    <div class="very-lightly-spaced-row">
                      <div class="label">{{ block.settings.heading | escape }}</div>
                    </div>
                    <div class="fixed-layout fixed-layout--no-wide-gutter">
                      {%- liquid
                        for related_product in recommendations.products limit: block.settings.max_products
                          echo '<div class="column column--half">'
                          render 'product-block', product: related_product, no_quick_buy: true, custom_aspect_ratio: chosen_aspect_ratio, grid: 5
                          echo '</div>'
                        endfor
                      -%}
                    </div>
                  {% endif %}
                </div>
              {%- endif -%}
            </cc-fetched-content>

          {% when 'countdown' %}
            <div class="lightly-spaced-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
              {%- liquid
                assign hide_on_end = block.settings.hide_on_end | default: false
                assign now = "now" | date: '%Y-%m-%dT%H:%M%z'
                if block.settings.end_date != blank
                  if block.settings.end_time != blank
                    assign end_date = block.settings.end_date | append: 'T' | append: block.settings.end_time
                  endif
                  assign end_date = end_date | date: '%Y-%m-%dT%H:%M%z'
                else
                  assign now_split = now | split: "T"
                  assign end_date = now_split.first | append: "T23:59%z" | date: '%Y-%m-%dT%H:%M%z'
                endif
              -%}
              {%- if end_date > now or hide_on_end == false -%}
                <script src="{{ 'countdown-timer.js' | asset_url }}" defer></script>
                <div class="product-info-block text-box text-box--wide align-center countdown-font-{{ block.settings.number_font }} countdown-divider-{{ block.settings.divider_type }}" style="--box-color: {{ block.settings.box_color }}; --box-text-color: {{ block.settings.text_color | color_to_rgb | split: '(' | last | split: ')' | first }}">
                  {%- if block.settings.heading != blank -%}
                    <div class="very-lightly-spaced-row">{{ block.settings.heading }}</div>
                  {%- endif -%}
                  {% render 'countdown-timer',
                    end_date: block.settings.end_date,
                    end_time: block.settings.end_time,
                    end_text: block.settings.end_text,
                    end_midnight: true,
                    hide_on_end: block.settings.hide_on_end,
                    show_labels: block.settings.show_timer_labels
                  %}
                </div>
              {%- endif -%}
            </div>

          {% when 'feature-rating' %}
            <link rel="stylesheet" href="{{ 'feature-rating.css' | asset_url }}">
            <div class="input-row{% unless block.settings.show_in_quickbuy %} not-in-quickbuy{% endunless %}" {{ block.shopify_attributes }}>
              {%- if block.settings.heading != blank -%}
                <div class="lightly-spaced-row"><strong role="heading" aria-level="2">{{ block.settings.heading }}</strong></div>
              {%- endif -%}

              {% render 'feature-rating',
                segments: block.settings.segments,
                active_segment: block.settings.active_segment,
                fill_segments: block.settings.fill_segments,
                show_labels: block.settings.show_labels,
                label_left: block.settings.label_left,
                label_middle: block.settings.label_middle,
                label_right: block.settings.label_right
              %}
            </div>

          {% when 'testimonial_under_gallery' %}
            {%- comment -%} Render in product info for mobile (desktop version is rendered under gallery if left_side is enabled) {%- endcomment -%}
            {% render 'testimonial-under-gallery', block: block, render_version: 'mobile' %}

        {% endcase %}
      {% endfor %}

      <div class="lightish-spaced-row-above only-in-quickbuy">
        <a class="more" href="{{ product.url }}">
          <span class="beside-svg underline">{{ 'products.product.view_details' | t }}</span>
          <span class="icon--small icon-natcol has-ltr-icon">{% render 'icon-chevron-right' %}</span>
        </a>
      </div>
    </div>
  </div>

  {%- render 'product-popups', product: product -%}

  {%- render 'structured-data-product', product: product, current_variant: product.selected_or_first_available_variant -%}
</product-form>

{%- if section.settings.show_location_underneath -%}
  <div class="product-description rte container cf padded-row not-in-quickbuy">{{ product.description }}</div>
{%- endif -%}

{%- if section.settings.enable_sticky_atc -%}
  {%- render 'sticky-atc', product: product, current_variant: current_variant -%}
{%- endif -%}

{% schema %}
{
  "name": "Product pages",
  "class": "section-main-product page-section-spacing page-section-spacing--no-top-mobile",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "select_first_variant",
      "label": "Select the first available variant",
      "info": "When disabled, the first product media always shows on page load",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_location_underneath",
      "label": "Show description below media",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "inventory_transfers_enable",
      "label": "Show inventory transfer notice",
      "info": "Shows under price. Learn how to create inventory transfers [here](https://help.shopify.com/en/manual/products/inventory/transfers/create-transfer)",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_columns",
      "label": "Enable sticky columns",
      "default": false
    },
    {
      "type": "header",
      "content": "Gallery"
    },
    {
      "type": "checkbox",
      "id": "enable_modern_gallery",
      "label": "Modern product gallery",
      "info": "Enable 2-column gallery on desktop and thumbnail navigation on mobile",
      "default": true
    },
    {
      "type": "header",
      "content": "Sticky 'Add to cart'"
    },
    {
      "type": "paragraph",
      "content": "A floating prompt to purchase the product, which appears after scrolling past the main product detail."
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_atc",
      "label": "Enable sticky 'Add to cart'",
      "default": true
    },
    {
      "visible_if": "{{ section.settings.enable_sticky_atc }}",
      "type": "select",
      "id": "sticky_atc_position",
      "label": "Position on large screens",
      "options": [
        {
          "value": "start",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "end",
          "label": "Right"
        }
      ],
      "default": "end"
    },
    {
      "visible_if": "{{ section.settings.enable_sticky_atc }}",
      "type": "checkbox",
      "id": "sticky_atc_mobile",
      "label": "Show on mobile",
      "default": true
    },
    {
      "visible_if": "{{ section.settings.enable_sticky_atc }}",
      "type": "select",
      "id": "sticky_atc_behavior",
      "label": "Behavior",
      "options": [
        {
          "value": "add_to_cart",
          "label": "Add to cart"
        },
        {
          "value": "scroll",
          "label": "Scroll"
        }
      ],
      "default": "add_to_cart"
    },
    {
      "visible_if": "{{ section.settings.enable_sticky_atc }}",
      "type": "select",
      "id": "sticky_atc_button_style",
      "label": "Button style",
      "default": "secondary",
      "options": [
        {
          "label": "Primary",
          "value": "primary"
        },
        {
          "label": "Secondary",
          "value": "secondary"
        }
      ]
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "paragraph",
      "content": "Learn more about [media types](https://help.shopify.com/en/manual/products/product-media)"
    },
    {
      "type": "select",
      "id": "gallery_size",
      "label": "Size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "medium"
    },
    {
      "type": "select",
      "id": "gallery_layout",
      "label": "Layout",
      "options": [
        {
          "value": "carousel-beside",
          "label": "Carousel - thumbnails left"
        },
        {
          "value": "carousel-under",
          "label": "Carousel - thumbnails below"
        },
        {
          "value": "columns-1",
          "label": "One column"
        },
        {
          "value": "columns-2",
          "label": "Two column"
        },
        {
          "value": "collage-1",
          "label": "Collage - style 1"
        },
        {
          "value": "collage-2",
          "label": "Collage - style 2"
        }
      ],
      "default": "carousel-under"
    },
    {
      "type": "checkbox",
      "id": "enable_zoom",
      "label": "Enable image zoom",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_alt_text",
      "label": "Show alt text over image",
      "default": false
    },
    {
      "visible_if": "{{ section.settings.show_alt_text }}",
      "type": "select",
      "id": "alt_text_icon",
      "label": "Alt text icon",
      "default": "",
      "options": [
        {
          "value": "",
          "label": "No icon"
        },
        {
          "value": "accessible",
          "label": "Accessible"
        },
        {
          "value": "award",
          "label": "Award"
        },
        {
          "value": "beach",
          "label": "Beach"
        },
        {
          "value": "box",
          "label": "Box"
        },
        {
          "value": "briefcase",
          "label": "Briefcase"
        },
        {
          "value": "calendar",
          "label": "Calendar"
        },
        {
          "value": "chat_bubble",
          "label": "Chat bubble"
        },
        {
          "value": "check_mark",
          "label": "Check mark"
        },
        {
          "value": "check_mark_in_circle",
          "label": "Check mark in circle"
        },
        {
          "value": "clock",
          "label": "Clock"
        },
        {
          "value": "credit_card",
          "label": "Credit card"
        },
        {
          "value": "dollar_sign",
          "label": "Dollar sign"
        },
        {
          "value": "dryer",
          "label": "Dryer"
        },
        {
          "value": "eye",
          "label": "Eye"
        },
        {
          "value": "feather",
          "label": "Feather"
        },
        {
          "value": "gift",
          "label": "Gift"
        },
        {
          "value": "heart",
          "label": "Heart"
        },
        {
          "value": "iron",
          "label": "Iron"
        },
        {
          "value": "leaf",
          "label": "Leaf"
        },
        {
          "value": "leather",
          "label": "Leather"
        },
        {
          "value": "lock",
          "label": "Lock"
        },
        {
          "value": "map_pin",
          "label": "Map pin"
        },
        {
          "value": "pants",
          "label": "Pants"
        },
        {
          "value": "percent",
          "label": "Percent"
        },
        {
          "value": "plane",
          "label": "Plane"
        },
        {
          "value": "price_tag",
          "label": "Price tag"
        },
        {
          "value": "question_mark",
          "label": "Question mark"
        },
        {
          "value": "recycle",
          "label": "Recycle"
        },
        {
          "value": "return",
          "label": "Return"
        },
        {
          "value": "ruler",
          "label": "Ruler"
        },
        {
          "value": "scissors",
          "label": "Scissors"
        },
        {
          "value": "shirt",
          "label": "Shirt"
        },
        {
          "value": "shoe",
          "label": "Shoe"
        },
        {
          "value": "silhouette",
          "label": "Silhouette"
        },
        {
          "value": "star",
          "label": "Star"
        },
        {
          "value": "sun-high",
          "label": "Sun"
        },
        {
          "value": "truck",
          "label": "Truck"
        },
        {
          "value": "washing",
          "label": "Washing"
        },
        {
          "value": "world",
          "label": "World"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "enable_video_autoplay",
      "label": "Autoplay videos",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "label": "Enable video looping",
      "default": false
    },
    {
      "type": "header",
      "content": "Media grouping"
    },
    {
      "type": "checkbox",
      "id": "enable_media_grouping",
      "label": "Show media only associated with the selected variant",
      "info": "Other variants' media will be hidden",
      "default": false
    },
    {
      "type": "text",
      "id": "media_grouping_option",
      "label": "Variant option label",
      "info": "The label used to switch between images",
      "default": "Color,Colour,Couleur,Farbe"
    },
    {
      "type": "paragraph",
      "content": "If your store displays multiple languages, include all translations separated by a comma, e.g. Color,Couleur,Farbe"
    },
    {
      "type": "paragraph",
      "content": "Arrange product media by this option (all 'red' media together, then all 'blue' media together, for example). The first media in each group should be assigned to a variant. [Read more](https://cleancanvas.co.uk/support/general/grouped-variant-images)"
    },
    {
      "type": "paragraph",
      "content": "Add the alt text 'all-groups' to show that media in all groups."
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "formula_button",
      "name": "Formula Button",
      "limit": 2
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_tax_and_shipping",
          "label": "Show tax status and shipping policy link",
          "default": false
        },
        {
          "type": "checkbox",
          "label": "Show product rating",
          "id": "enable_product_reviews_by_price",
          "info": "Add reviews by installing [an app](https://apps.shopify.com/search?q=reviews). App must support Shopify's standard rating metafield.",
          "default": true
        }
      ]
    },
     {
      "type": "video_slide",
      "name": "Video Slide",
      "settings": [
        {
          "type": "header",
          "content": "Title Settings"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Walk It Like a Bandit",
          "info": "Title will be shown once for all video slides in the group"
        },
        {
          "type": "range",
          "id": "title_size",
          "min": 12,
          "max": 48,
          "step": 2,
          "unit": "px",
          "label": "Title Size",
          "default": 24
        },
        {
          "type": "header",
          "content": "Media Settings"
        },
        {
          "type": "select",
          "id": "media_type",
          "options": [
            {
              "value": "image",
              "label": "Image"
            },
            {
              "value": "video",
              "label": "Video"
            }
          ],
          "default": "image",
          "label": "Media Type"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Used when Media Type is set to Image"
        },
        {
          "type": "video",
          "id": "video",
          "label": "Video",
          "info": "Used when Media Type is set to Video (Shopify video)"
        },
        {
          "type": "video_url",
          "id": "video_url",
          "label": "Video URL",
          "accept": ["youtube", "vimeo"],
          "default": "https://www.youtube.com/watch?v=_9VUPq3SxOc",
          "info": "Used when Media Type is set to Video (External video)"
        },
        {
          "type": "text",
          "id": "video_host",
          "label": "Video Host",
          "default": "youtube",
          "info": "Enter 'youtube' or 'vimeo'"
        },
        {
          "type": "text",
          "id": "video_id",
          "label": "Video ID",
          "info": "YouTube playlist ID (optional)"
        },
        {
          "type": "image_picker",
          "id": "poster_image",
          "label": "Poster Image",
          "info": "Thumbnail image for video (optional)"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Alt Text",
          "default": "Video slide"
        },
        {
          "type": "header",
          "content": "Style Settings"
        },
        {
          "type": "range",
          "id": "border_radius",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Border Radius (Desktop)",
          "default": 8
        },
        {
          "type": "range",
          "id": "border_radius_mobile",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Border Radius (Mobile)",
          "default": 8
        }
      ]
    },
    {
      "type": "testimonial_under_gallery",
      "name": "Testimonial Under Gallery",
      "settings": [
        {
          "type": "checkbox",
          "id": "left_side",
          "label": "Show on Left Side (Under Gallery)",
          "default": true
        },
        {
          "type": "header",
          "content": "Spacing & Style"
        },
        {
          "type": "range",
          "id": "padding",
          "min": 0,
          "max": 60,
          "step": 2,
          "unit": "px",
          "label": "Padding",
          "default": 24
        },
        {
          "type": "range",
          "id": "border_radius",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "label": "Border Radius",
          "default": 16
        },
        {
          "type": "range",
          "id": "margin_top",
          "min": 0,
          "max": 60,
          "step": 2,
          "unit": "px",
          "label": "Margin Top",
          "default": 20
        },
        {
          "type": "color",
          "id": "border_color",
          "label": "Border Color",
          "default": "#E8E8E8"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#F8F7F4"
        },
        {
          "type": "header",
          "content": "Rating Icons"
        },
        {
          "type": "image_picker",
          "id": "rating_icon_1",
          "label": "Rating Icon 1"
        },
        {
          "type": "image_picker",
          "id": "rating_icon_2",
          "label": "Rating Icon 2"
        },
        {
          "type": "image_picker",
          "id": "rating_icon_3",
          "label": "Rating Icon 3"
        },
        {
          "type": "image_picker",
          "id": "rating_icon_4",
          "label": "Rating Icon 4"
        },
        {
          "type": "image_picker",
          "id": "rating_icon_5",
          "label": "Rating Icon 5"
        },
        {
          "type": "header",
          "content": "Content"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "I've been telling all my family and friends about you!!! They are so excited and eager to get their oils too! "
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle (Author Name)",
          "default": "Lauren P."
        },
        {
          "type": "text",
          "id": "verification_text",
          "label": "Verification Text",
          "default": "Verified Buyer"
        },
        {
          "type": "image_picker",
          "id": "verification_icon",
          "label": "Verification Icon"
        },
        {
          "type": "header",
          "content": "Main Image"
        },
        {
          "type": "image_picker",
          "id": "main_image",
          "label": "Main Image (Person Photo)"
        },
        {
          "type": "range",
          "id": "main_image_width",
          "min": 100,
          "max": 400,
          "step": 10,
          "unit": "px",
          "label": "Main Image Width",
          "default": 280
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_in_tab",
          "label": "Show in tab",
          "default": false
        },
        {
          "visible_if": "{{ block.settings.open_tab }}",
          "type": "checkbox",
          "id": "open_tab",
          "label": "Open tab",
          "default": false
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "vendor",
      "name": "Vendor",
      "limit": 1
    },
    {
      "type": "sku",
      "name": "SKU",
      "limit": 1
    },
    {
      "type": "barcode",
      "name": "Barcode (ISBN, UPC, etc)",
      "limit": 1
    },
    {
      "type": "variant-picker",
      "name": "Variant picker",
      "settings": [
        {
          "type": "checkbox",
          "id": "show_single",
          "label": "Show for a single variant",
          "default": false
        },
        {
          "type": "select",
          "id": "selector_style",
          "label": "Variant style",
          "options": [
            {
              "value": "listed",
              "label": "Buttons"
            },
            {
              "value": "dropdown",
              "label": "Dropdown"
            }
          ],
          "default": "listed"
        },
        {
          "type": "select",
          "id": "dynamic_availability",
          "label": "Dynamic availability",
          "info": "When an option is selected, options below it will be updated to show their availability",
          "options": [
            {
              "value": "off",
              "label": "Off"
            },
            {
              "value": "show",
              "label": "Show"
            },
            {
              "value": "prune",
              "label": "Prune"
            }
          ],
          "default": "show"
        },
        {
          "type": "header",
          "content": "Size guide"
        },
        {
          "type": "checkbox",
          "id": "enable_size_chart",
          "label": "Enable size guide",
          "default": false
        },
        {
          "type": "text",
          "id": "size_chart_label",
          "label": "Link text",
          "default": "Size guide"
        },
        {
          "type": "text",
          "id": "size_chart_variant",
          "label": "Variant option name",
          "info": "This is usually 'Size'",
          "default": "Size"
        },
        {
          "type": "page",
          "id": "size_chart_page",
          "label": "Page containing size guide"
        }
      ],
      "limit": 1
    },
    {
  "type": "buy-buttons",
  "name": "Buy buttons",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_quantity_selector",
      "label": "Show quantity selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_payment_button",
      "label": "Show dynamic checkout button",
      "info": "Lets customers check out directly using a familiar payment method. [Learn more](https://help.shopify.com/manual/using-themes/change-the-layout/dynamic-checkout)",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_gift_card_recipient",
      "label": "Show gift card recipient form",
      "info": "Only applies to gift card products",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_pickup_availability",
      "label": "Show pickup availability",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_backorder_text",
      "label": "Show backorder text",
      "default": true
    },
    {
      "type": "header",
      "content": "Quiz Settings"
    },
     {
      "type": "text",
      "id": "sub-block-label",
      "label": "Title for subscription block",
      "default": "SUBSCRIBE AND SAVE 15%"
    },
    {
      "type": "text",
      "id": "quiz_cta_text",
      "label": "Quiz CTA Button Text",
      "default": "Get Your Formula",
      "info": "Text displayed when quiz is not completed"
    },
    {
      "type": "url",
      "id": "quiz_cta_url",
      "label": "Quiz CTA Button Link",
      "info": "URL to your quiz page"
    },
    {
      "type": "header",
      "content": "Subscription Picker"
    },
    {
      "type": "checkbox",
      "id": "enable_subscription_picker",
      "label": "Enable Subscription Picker",
      "default": true,
      "info": "Show subscription options before add to cart button"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "subscription_title",
      "label": "Subscription Title",
      "default": "SUBSCRIBE AND SAVE 15%",
      "info": "Main heading above subscription options"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "select",
      "id": "default_selection",
      "label": "Default Selection",
      "options": [
        {
          "value": "subscription",
          "label": "Subscribe & Save"
        },
        {
          "value": "one-time",
          "label": "One-time Purchase"
        }
      ],
      "default": "subscription"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "header",
      "content": "Labels"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "one_time_label",
      "label": "One-time Purchase Label",
      "default": "One-time purchase"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "subscribe_label",
      "label": "Subscribe & Save Label",
      "default": "Subscribe & Save"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "interval_label",
      "label": "Interval Label",
      "default": "Deliver & Pay every",
      "info": "Label for the subscription interval dropdown"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "header",
      "content": "Badges & Tags"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "checkbox",
      "id": "show_most_popular",
      "label": "Show 'Most Popular' Badge",
      "default": true
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "most_popular_text",
      "label": "Most Popular Badge Text",
      "default": "MOST POPULAR"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "savings_badge_text",
      "label": "Savings Badge Text",
      "default": "SAVE 25%",
      "info": "Badge text shown next to Subscribe & Save label"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "header",
      "content": "Subscription Benefits with Icons"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "richtext",
      "id": "subscription_benefits",
      "label": "Subscription Benefits (with Icons)",
      "default": "<ul><li>Save 30% on Every Custom Formula</li><li>Pause, Skip, or Cancel After 3 Deliveries</li><li>Free Shipping + Never Run Out During Your Hair Journey</li></ul>",
      "info": "List of benefits shown under Subscribe & Save option. Use HTML list format. You can add SVG icons inside <li> tags as the first element. Example: <ul><li><svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10 0L12.5 7.5L20 10L12.5 12.5L10 20L7.5 12.5L0 10L7.5 7.5L10 0Z\" fill=\"#1A365D\"/></svg>Save 30% on Every Custom Formula</li><li><svg>...</svg>Another benefit</li></ul>"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "checkbox",
      "id": "use_custom_benefits",
      "label": "Use Custom Benefits (Override Seal Subscriptions)",
      "default": false,
      "info": "If enabled, custom benefits from above will be used instead of data from Seal Subscriptions app"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "header",
      "content": "Subscription Details"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "text",
      "id": "subscription_details_label",
      "label": "Subscription Details Label",
      "default": "Subscription details"
    },
    {
      "visible_if": "{{ block.settings.enable_subscription_picker }}",
      "type": "richtext",
      "id": "subscription_details",
      "label": "Subscription Details Content",
      "default": "<p><strong>How subscriptions work</strong></p><p>I agree this subscription will continue until I cancel; I will be charged the amount stated above at the interval stated above to the credit or debit card used to complete this purchase.</p><p>Cancellations are only allowed after the first 3 payments have been completed. After the initial 3 payments, cancellations are effective at the end of the then-current subscription period. To avoid future charges, cancel at least 5 business days prior to renewal.</p><p>You may cancel your membership after completing 3 payments online in the account portal or by emailing us via customerservice@afsennah.com</p>",
      "info": "Detailed information about subscription terms. Shown in collapsible details section."
    },
    {
      "type": "header",
      "content": "Text above checkout"
    },
    {
      "type": "richtext",
      "id": "text_above_checkout",
      "label": "Text",
      "info": "Text displayed above the checkout button"
    },
    {
      "type": "select",
      "id": "text_icon",
      "label": "Icon",
      "default": "",
      "options": [
        {
          "value": "",
          "label": "No icon"
        },
        {
          "value": "accessible",
          "label": "Accessible"
        },
        {
          "value": "award",
          "label": "Award"
        },
        {
          "value": "beach",
          "label": "Beach"
        },
        {
          "value": "box",
          "label": "Box"
        },
        {
          "value": "briefcase",
          "label": "Briefcase"
        },
        {
          "value": "calendar",
          "label": "Calendar"
        },
        {
          "value": "chat_bubble",
          "label": "Chat bubble"
        },
        {
          "value": "check_mark",
          "label": "Check mark"
        },
        {
          "value": "check_mark_in_circle",
          "label": "Check mark in circle"
        },
        {
          "value": "clock",
          "label": "Clock"
        },
        {
          "value": "credit_card",
          "label": "Credit card"
        },
        {
          "value": "dollar_sign",
          "label": "Dollar sign"
        },
        {
          "value": "dryer",
          "label": "Dryer"
        },
        {
          "value": "eye",
          "label": "Eye"
        },
        {
          "value": "feather",
          "label": "Feather"
        },
        {
          "value": "gift",
          "label": "Gift"
        },
        {
          "value": "heart",
          "label": "Heart"
        },
        {
          "value": "iron",
          "label": "Iron"
        },
        {
          "value": "leaf",
          "label": "Leaf"
        },
        {
          "value": "leather",
          "label": "Leather"
        },
        {
          "value": "lock",
          "label": "Lock"
        },
        {
          "value": "map_pin",
          "label": "Map pin"
        },
        {
          "value": "pants",
          "label": "Pants"
        },
        {
          "value": "percent",
          "label": "Percent"
        },
        {
          "value": "plane",
          "label": "Plane"
        },
        {
          "value": "price_tag",
          "label": "Price tag"
        },
        {
          "value": "question_mark",
          "label": "Question mark"
        },
        {
          "value": "recycle",
          "label": "Recycle"
        },
        {
          "value": "return",
          "label": "Return"
        },
        {
          "value": "ruler",
          "label": "Ruler"
        },
        {
          "value": "scissors",
          "label": "Scissors"
        },
        {
          "value": "shirt",
          "label": "Shirt"
        },
        {
          "value": "shoe",
          "label": "Shoe"
        },
        {
          "value": "silhouette",
          "label": "Silhouette"
        },
        {
          "value": "star",
          "label": "Star"
        },
        {
          "value": "sun-high",
          "label": "Sun"
        },
        {
          "value": "truck",
          "label": "Truck"
        },
        {
          "value": "washing",
          "label": "Washing"
        },
        {
          "value": "world",
          "label": "World"
        }
      ]
    },
    {
      "type": "image_picker",
      "id": "text_custom_icon",
      "label": "Custom icon"
    },
    {
      "type": "select",
      "id": "text_icon_size",
      "label": "Icon size",
      "default": "small",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "enable_text_box",
      "label": "Enable box style",
      "default": false
    },
    {
      "visible_if": "{{ block.settings.enable_text_box }}",
      "type": "color",
      "id": "text_box_color",
      "label": "Box color",
      "info": "Suggestions: Blue #e5f3ff, Teal #e0f5f5, Green #e0f4d5, Yellow #fcf1cd, Red #fbeae5",
      "default": "#e0f4d5"
    },
    {
      "type": "header",
      "content": "USP Badges"
    },
    {
      "type": "checkbox",
      "id": "show_usp_badges",
      "label": "Show USP badges above checkout button",
      "default": true
    },
    {
      "visible_if": "{{ block.settings.show_usp_badges }}",
      "type": "text",
      "id": "usp_1_label",
      "label": "USP 1 label",
      "default": "Trichologist-Developed"
    },
    {
      "visible_if": "{{ block.settings.show_usp_badges }}",
      "type": "text",
      "id": "usp_2_label",
      "label": "USP 2 label",
      "default": "Clean Ingredients"
    },
    {
      "visible_if": "{{ block.settings.show_usp_badges }}",
      "type": "text",
      "id": "usp_3_label",
      "label": "USP 3 label",
      "default": "Cruelty-Free"
    }
  ]
},
    {
      "type": "inventory-level",
      "name": "Inventory level",
      "settings": [
        {
          "type": "select",
          "id": "show_inventory_notice",
          "label": "Show inventory notice",
          "options": [
            {
              "label": "When inventory low",
              "value": "low"
            },
            {
              "label": "Always",
              "value": "always"
            }
          ],
          "default": "low"
        },
        {
          "type": "select",
          "id": "show_inventory_count",
          "label": "Show count in inventory notice",
          "options": [
            {
              "label": "Never",
              "value": "never"
            },
            {
              "label": "When inventory low",
              "value": "low"
            },
            {
              "label": "Always",
              "value": "always"
            }
          ],
          "default": "low"
        },
        {
          "type": "range",
          "id": "inventory_threshold",
          "min": 1,
          "max": 100,
          "step": 1,
          "label": "Low inventory threshold",
          "default": 10
        },
        {
          "type": "checkbox",
          "id": "enable_box",
          "label": "Enable box style",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "enable_pulse",
          "label": "Enable pulse",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": true
        }
      ]
    },
    {
      "type": "accordion",
      "name": "Collapsible tab",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Collapsible tab"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Tab content",
          "default": "<p>Collapsible tab content</p>"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Tab content from page"
        },
        {
          "type": "liquid",
          "id": "custom_liquid",
          "label": "Liquid code"
        },
        {
          "type": "checkbox",
          "id": "open",
          "label": "Open",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Text block"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom icon"
        },
        {
          "type": "select",
          "id": "icon_size",
          "label": "Icon size",
          "default": "small",
          "options": [
            {
              "value": "small",
              "label": "Small"
            },
            {
              "value": "large",
              "label": "Large"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "enable_box",
          "label": "Enable box style",
          "default": false
        },
        {
          "visible_if": "{{ block.settings.enable_box }}",
          "type": "color",
          "id": "box_color",
          "label": "Box color",
          "info": "Suggestions: Blue #e5f3ff, Teal #e0f5f5, Green #e0f4d5, Yellow #fcf1cd, Red #fbeae5",
          "default": "#e0f4d5"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "richtext",
      "name": "Rich text",
      "settings": [
        {
          "type": "richtext",
          "id": "richtext",
          "label": "Rich text",
          "default": "<p>Rich text block</p>"
        },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "default": "",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom icon"
        },
        {
          "type": "select",
          "id": "icon_size",
          "label": "Icon size",
          "default": "small",
          "options": [
            {
              "value": "small",
              "label": "Small"
            },
            {
              "value": "large",
              "label": "Large"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "enable_box",
          "label": "Enable box style",
          "default": false
        },
        {
          "visible_if": "{{ block.settings.enable_box }}",
          "type": "color",
          "id": "box_color",
          "label": "Box color",
          "info": "Suggestions: Blue #e5f3ff, Teal #e0f5f5, Green #e0f4d5, Yellow #fcf1cd, Red #fbeae5",
          "default": "#e0f4d5"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        },
        {
          "type": "header",
          "content": "Desktop Styles"
        },
        {
          "type": "color",
          "id": "desktop_background_color",
          "label": "Background color",
          "default": "#ffffff"
        },
        {
          "type": "range",
          "id": "desktop_border_radius",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "label": "Border radius",
          "default": 0
        },
        {
          "type": "range",
          "id": "desktop_padding",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Padding",
          "default": 0
        },
        {
          "type": "header",
          "content": "Mobile Styles"
        },
        {
          "type": "color",
          "id": "mobile_background_color",
          "label": "Background color",
          "default": "#ffffff"
        },
        {
          "type": "range",
          "id": "mobile_border_radius",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "label": "Border radius",
          "default": 0
        },
        {
          "type": "range",
          "id": "mobile_padding",
          "min": 0,
          "max": 100,
          "step": 2,
          "unit": "px",
          "label": "Padding",
          "default": 0
        }
      ]
    },
    {
      "type": "pop-up",
      "name": "Pop-up",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Link text",
          "default": "Pop-up link text"
        },
        {
          "type": "select",
          "id": "style",
          "label": "Style",
          "default": "primary",
          "options": [
            {
              "label": "Primary",
              "value": "primary"
            },
            {
              "label": "Primary - wide",
              "value": "primary btn--wide"
            },
            {
              "label": "Secondary",
              "value": "secondary"
            },
            {
              "label": "Secondary - wide",
              "value": "secondary btn--wide"
            },
            {
              "label": "Link",
              "value": "link"
            }
          ]
        },
        {
          "type": "page",
          "id": "page",
          "label": "Page"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "link",
      "name": "Link",
      "settings": [
        {
          "type": "url",
          "id": "url",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "open_in_new_tab",
          "label": "Open link in new tab",
          "default": false
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Link text"
        },
        {
          "type": "select",
          "id": "style",
          "label": "Style",
          "default": "primary",
          "options": [
            {
              "label": "Primary",
              "value": "primary"
            },
            {
              "label": "Primary - wide",
              "value": "primary btn--wide"
            },
            {
              "label": "Secondary",
              "value": "secondary"
            },
            {
              "label": "Secondary - wide",
              "value": "secondary btn--wide"
            },
            {
              "label": "Link",
              "value": "link"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "range",
          "id": "image_width",
          "min": 60,
          "max": 700,
          "step": 10,
          "unit": "px",
          "label": "Image width",
          "default": 700
        },
        {
          "type": "url",
          "id": "url",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "open_in_new_tab",
          "label": "Open link in new tab",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "icon-columns",
      "name": "Icon columns",
      "settings": [
        {
          "type": "select",
          "id": "icon_size",
          "label": "Icon size",
          "default": "medium",
          "options": [
            {
              "value": "medium",
              "label": "Small"
            },
            {
              "value": "large",
              "label": "Medium"
            },
            {
              "value": "extra-large",
              "label": "Large"
            }
          ]
        },
        {
          "type": "select",
          "id": "text_size",
          "label": "Text size",
          "default": "sm",
          "options": [
            {
              "value": "sm",
              "label": "Small"
            },
            {
              "value": "md",
              "label": "Medium"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "enable_box",
          "label": "Enable box style",
          "default": true
        },
        {
          "visible_if": "{{ block.settings.enable_box }}",
          "type": "color",
          "id": "box_color",
          "label": "Box color",
          "default": "#f4f4f4"
        },
        {
          "type": "header",
          "content": "Icon 1"
        },
        {
          "type": "select",
          "id": "icon_1",
          "label": "Icon",
          "default": "truck",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "visible_if": "{{ block.settings.icon_1 != blank }}",
          "type": "color",
          "id": "icon_1_color",
          "label": "Icon color",
          "default": "rgba(0,0,0,0)"
        },
        {
          "type": "image_picker",
          "id": "custom_icon_1",
          "label": "Custom icon"
        },
        {
          "type": "text",
          "id": "icon_1_heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "icon_1_text",
          "label": "Text",
          "default": "Icon label 1"
        },
        {
          "type": "header",
          "content": "Icon 2"
        },
        {
          "type": "select",
          "id": "icon_2",
          "label": "Icon",
          "default": "map_pin",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "visible_if": "{{ block.settings.icon_2 != blank }}",
          "type": "color",
          "id": "icon_2_color",
          "label": "Icon color",
          "default": "rgba(0,0,0,0)"
        },
        {
          "type": "image_picker",
          "id": "custom_icon_2",
          "label": "Custom icon"
        },
        {
          "type": "text",
          "id": "icon_2_heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "icon_2_text",
          "label": "Text",
          "default": "Icon label 2"
        },
        {
          "type": "header",
          "content": "Icon 3"
        },
        {
          "type": "select",
          "id": "icon_3",
          "label": "Icon",
          "default": "gift",
          "options": [
            {
              "value": "",
              "label": "No icon"
            },
            {
              "value": "accessible",
              "label": "Accessible"
            },
            {
              "value": "award",
              "label": "Award"
            },
            {
              "value": "beach",
              "label": "Beach"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "briefcase",
              "label": "Briefcase"
            },
            {
              "value": "calendar",
              "label": "Calendar"
            },
            {
              "value": "chat_bubble",
              "label": "Chat bubble"
            },
            {
              "value": "check_mark",
              "label": "Check mark"
            },
            {
              "value": "check_mark_in_circle",
              "label": "Check mark in circle"
            },
            {
              "value": "clock",
              "label": "Clock"
            },
            {
              "value": "credit_card",
              "label": "Credit card"
            },
            {
              "value": "dollar_sign",
              "label": "Dollar sign"
            },
            {
              "value": "dryer",
              "label": "Dryer"
            },
            {
              "value": "eye",
              "label": "Eye"
            },
            {
              "value": "feather",
              "label": "Feather"
            },
            {
              "value": "gift",
              "label": "Gift"
            },
            {
              "value": "heart",
              "label": "Heart"
            },
            {
              "value": "iron",
              "label": "Iron"
            },
            {
              "value": "leaf",
              "label": "Leaf"
            },
            {
              "value": "leather",
              "label": "Leather"
            },
            {
              "value": "lock",
              "label": "Lock"
            },
            {
              "value": "map_pin",
              "label": "Map pin"
            },
            {
              "value": "pants",
              "label": "Pants"
            },
            {
              "value": "percent",
              "label": "Percent"
            },
            {
              "value": "plane",
              "label": "Plane"
            },
            {
              "value": "price_tag",
              "label": "Price tag"
            },
            {
              "value": "question_mark",
              "label": "Question mark"
            },
            {
              "value": "recycle",
              "label": "Recycle"
            },
            {
              "value": "return",
              "label": "Return"
            },
            {
              "value": "ruler",
              "label": "Ruler"
            },
            {
              "value": "scissors",
              "label": "Scissors"
            },
            {
              "value": "shirt",
              "label": "Shirt"
            },
            {
              "value": "shoe",
              "label": "Shoe"
            },
            {
              "value": "silhouette",
              "label": "Silhouette"
            },
            {
              "value": "star",
              "label": "Star"
            },
            {
              "value": "sun-high",
              "label": "Sun"
            },
            {
              "value": "truck",
              "label": "Truck"
            },
            {
              "value": "washing",
              "label": "Washing"
            },
            {
              "value": "world",
              "label": "World"
            }
          ]
        },
        {
          "visible_if": "{{ block.settings.icon_3 != blank }}",
          "type": "color",
          "id": "icon_3_color",
          "label": "Icon color",
          "default": "rgba(0,0,0,0)"
        },
        {
          "type": "image_picker",
          "id": "custom_icon_3",
          "label": "Custom icon"
        },
        {
          "type": "text",
          "id": "icon_3_heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "icon_3_text",
          "label": "Text",
          "default": "Icon label 3"
        },
        {
          "type": "header",
          "content": "Layout"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "custom-option",
      "name": "Custom option",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "info": "Required",
          "default": "Custom option"
        },
        {
          "type": "select",
          "id": "type",
          "label": "Type",
          "default": "text",
          "options": [
            {
              "label": "Text",
              "value": "text"
            },
            {
              "label": "Long text",
              "value": "textarea"
            },
            {
              "label": "Checkbox",
              "value": "checkbox"
            },
            {
              "label": "Multiple options",
              "value": "multiple"
            }
          ]
        },
        {
          "visible_if": "{{ block.settings.type == 'text' or block.settings.type == 'textarea' }}",
          "type": "header",
          "content": "Text"
        },
        {
          "visible_if": "{{ block.settings.type == 'text' or block.settings.type == 'textarea' }}",
          "type": "checkbox",
          "id": "text_required",
          "label": "Require text",
          "info": "Only works with 'Add to cart' button",
          "default": false
        },
        {
          "visible_if": "{{ block.settings.type == 'checkbox' }}",
          "type": "header",
          "content": "Checkbox"
        },
        {
          "visible_if": "{{ block.settings.type == 'checkbox' }}",
          "type": "text",
          "id": "checkbox_checked_value",
          "label": "Checked value",
          "default": "Yes"
        },
        {
          "visible_if": "{{ block.settings.type == 'checkbox' }}",
          "type": "text",
          "id": "checkbox_unchecked_value",
          "label": "Unchecked value",
          "default": "No"
        },
        {
          "visible_if": "{{ block.settings.type == 'multiple' }}",
          "type": "header",
          "content": "Multiple options"
        },
        {
          "visible_if": "{{ block.settings.type == 'multiple' }}",
          "type": "select",
          "id": "multiple_style",
          "label": "Style",
          "default": "dropdown",
          "options": [
            {
              "label": "Dropdown",
              "value": "dropdown"
            },
            {
              "label": "Radio",
              "value": "radio"
            }
          ]
        },
        {
          "visible_if": "{{ block.settings.type == 'multiple' }}",
          "type": "textarea",
          "id": "multiple_options",
          "label": "Options",
          "default": "Option 1\nOption 2\nOption 3",
          "info": "One option on each line"
        }
      ]
    },
    {
      "type": "custom-liquid",
      "name": "Custom Liquid",
      "settings": [
        {
          "type": "liquid",
          "id": "custom_liquid",
          "label": "Liquid code"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "related-products",
      "name": "Product list",
      "settings": [
        {
          "type": "paragraph",
          "content": "To use a different list for each product, use a product reference list [metafield](https://help.shopify.com/en/manual/metafields) as a dynamic source."
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "info": "Only shows if products are present",
          "default": "Product list"
        },
        {
          "type": "product_list",
          "id": "product_list",
          "label": "Products"
        },
        {
          "type": "header",
          "content": "Layout"
        },
        {
          "type": "select",
          "id": "style",
          "label": "Style",
          "default": "card",
          "options": [
            {
              "label": "Card",
              "value": "card"
            },
            {
              "label": "Image",
              "value": "image"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": "Choose 'Image' style for sibling products. [Read more](https://cleancanvas.co.uk/support/symmetry/sibling-products)"
        },
        {
          "type": "range",
          "id": "image_width",
          "min": 20,
          "max": 120,
          "step": 2,
          "unit": "px",
          "label": "Image width",
          "default": 68
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "product-upsells",
      "name": "Product Upsells",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "You may like"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "No consultation required*"
        },
        {
          "type": "product_list",
          "id": "product_list",
          "label": "Products"
        },
        {
          "type": "select",
          "id": "color_scheme",
          "label": "Color scheme",
          "default": "1",
          "options": [
            {
              "value": "default",
              "label": "Default"
            },
            {
              "value": "1",
              "label": "1"
            },
            {
              "value": "2",
              "label": "2"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "complementary",
      "name": "Complementary products",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": "To select complementary products, add the Search & Discovery app. [Learn more](https://shopify.dev/themes/product-merchandising/recommendations)"
        },
        {
          "type": "text",
          "id": "heading",
          "default": "Pairs well with",
          "label": "Heading"
        },
        {
          "type": "checkbox",
          "id": "enable_carousel",
          "label": "Enable carousel",
          "default": true
        },
        {
          "type": "range",
          "id": "max_products",
          "min": 1,
          "max": 10,
          "step": 1,
          "label": "Maximum products to show",
          "default": 10
        }
      ]
    },
    {
      "type": "feature-rating",
      "name": "Fit / Feature rating",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Fit"
        },
        {
          "type": "range",
          "id": "segments",
          "min": 4,
          "max": 10,
          "step": 1,
          "label": "Segments",
          "default": 5
        },
        {
          "type": "text",
          "id": "active_segment",
          "label": "Active segment",
          "default": "4"
        },
        {
          "type": "checkbox",
          "id": "fill_segments",
          "label": "Fill segments up to active segment",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_labels",
          "label": "Show labels",
          "info": "Labels will be read by screen readers when hidden.",
          "default": true
        },
        {
          "type": "text",
          "id": "label_left",
          "label": "Left label",
          "default": "Small"
        },
        {
          "type": "text",
          "id": "label_middle",
          "label": "Middle label",
          "info": "Optional",
          "default": "True to size"
        },
        {
          "type": "text",
          "id": "label_right",
          "label": "Right label",
          "default": "Large"
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "countdown",
      "name": "Countdown timer",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Countdown timer"
        },
        {
          "type": "text",
          "id": "end_date",
          "label": "End date",
          "info": "Required. Format: YYYY-MM-DD."
        },
        {
          "type": "text",
          "id": "end_time",
          "label": "End time (optional)",
          "info": "Format: 17:00 (24 hour clock). Uses the store's timezone."
        },
        {
          "type": "richtext",
          "id": "end_text",
          "label": "End text",
          "info": "This shows when the date and time elapses."
        },
        {
          "type": "checkbox",
          "id": "hide_on_end",
          "label": "Hide the timer when the date and time elapses",
          "default": false
        },
        {
          "type": "color",
          "id": "box_color",
          "label": "Box color",
          "default": "#323232"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#ffffff"
        },
        {
          "type": "select",
          "id": "number_font",
          "label": "Number font",
          "options": [
            {
              "label": "Text font",
              "value": "base"
            },
            {
              "label": "Heading font",
              "value": "heading"
            }
          ],
          "default": "base"
        },
        {
          "type": "select",
          "id": "divider_type",
          "label": "Divider type",
          "default": "colon",
          "options": [
            {
              "value": "colon",
              "label": "Colon"
            },
            {
              "value": "dot",
              "label": "Dot"
            },
            {
              "value": "line",
              "label": "Line"
            },
            {
              "value": "none",
              "label": "None"
            }
          ]
        },
        {
          "type": "checkbox",
          "id": "show_timer_labels",
          "label": "Show labels",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    },
    {
      "type": "sharing",
      "name": "Sharing",
      "settings": [
        {
          "type": "checkbox",
          "id": "show_twitter",
          "label": "Show X (formerly Twitter)",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_facebook",
          "label": "Show Facebook",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "show_pinterest",
          "label": "Show Pinterest",
          "default": true
        }
      ],
      "limit": 1
    },
    {
      "type": "divider",
      "name": "Divider",
      "settings": [
        {
          "type": "checkbox",
          "id": "show_in_quickbuy",
          "label": "Show in quick buy",
          "default": false
        }
      ]
    }
  ]
}
{% endschema %}
